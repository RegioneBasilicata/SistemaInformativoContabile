<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=Cp1252" />
<script src="../dbdoc.js" type="text/javascript"></script>
<link href="../dbdoc.css" type="text/css" rel="stylesheet">
</head>
<body class="object">
<div id="header"><h2>VM_COSTI_BENI_MOBILI</h2>
<div class="tabs clearfix">

<div class="tab"><div><a href="VM_COSTI_BENI_MOBILI.html">Colonne</a></div></div>
<div class="tab"><div><a href="VM_COSTI_BENI_MOBILI_Indici.html">Indici</a></div></div>
<div class="tab"><div><a href="VM_COSTI_BENI_MOBILI_Autorizzazioni.html">Autorizzazioni</a></div></div>
<div class="tab"><div><a href="VM_COSTI_BENI_MOBILI_Dipendenze.html">Dipendenze</a></div></div>
<div class="tab" id="current"><div><a href="VM_COSTI_BENI_MOBILI_Dettagli.html">Dettagli</a></div></div>
</div></div><br/>
<div class="tab-panes">
<div id="Dettagli"> <table cellpadding="0" cellspacing="0" cellspacing="0" summary=""><tr>
	<th>Name</th>
	<th>Value</th>
</tr>
	<tr>
<td>CREATED</td>
<td>2011-12-07</td>
	</tr>
	<tr>
<td>LAST_DDL_TIME</td>
<td>2017-06-07</td>
	</tr>
	<tr>
<td>OWNER</td>
<td>GAT2</td>
	</tr>
	<tr>
<td>MVIEW_NAME</td>
<td>VM_COSTI_BENI_MOBILI</td>
	</tr>
	<tr>
<td>CONTAINER_NAME</td>
<td>VM_COSTI_BENI_MOBILI</td>
	</tr>
	<tr>
<td>QUERY</td>
<td>SELECT DISTINCT
    cat.tipo tipo_bene,
    m.cod_inv codice_bene,
    scat.descrizione sottocategoria,
    p.descrizione produttore,
    det.descrizione modello,
    m.descr_agg descr_bene,
    a.ass_matricola,
    (a.ass_cognome
    ||' '
    ||a.ass_nome) utente,
    REPLACE(NVL(s.dipartimento,'71')
    ||' - '
    ||NVL(s.desc_dipartimento,'DIPARTIMENTO PRESIDENZA GIUNTA'),'''','')
    dipartimento,
    REPLACE(DECODE( NVL(s.struttura,DECODE(cat.tipo,'IN','71AM','71AL')) ,
    '800D','80D' ,NVL(s.struttura,DECODE(cat.tipo,'IN','71AM','71AL')) )
    ||' - '
    ||s.descrizione,'''','') ufficio,
    i.data_doc data_acquisto,
    NVL(r.pr_unit,0) *(1-NVL(r.perc_sconto,0)/100)*(1+NVL(to_number(
    r.tbi_cod_iva),0)/100) costo_bene,
    to_number(r.tbi_cod_iva) perc_iva,
    to_number(r.perc_sconto) perc_sconto,
    NVL(r.pr_unit,0) prezzo_unitario,
    i.num_doc numero_fattura,
    'F' f_b,
    m.rfid
  FROM
    tb_beni_mobili m ,
    tb_cat_cesp cat,
    tb_scat_cesp scat,
    tb_dett_scat det ,
    hs_produttori p ,
    tb_doc_iva i ,
    tb_righi_doc r ,
    vw_dipartimenti_strutture s ,
    tb_beni_ass a
  WHERE
    NVL(m.bf_tipo,'X')                                       = 'F'
  AND m.bf_numero                                            = i.chiave
  AND m.bf_numero                                            = r.tbdi_tbtd_chiave
  AND m.bf_progr_rigo                                        = r.progr
  AND a.codice(+)                                            = m.cod_inv
  AND a.data_fine_ass(+)                                    IS NULL
  AND NVL(a.ass_ufficio,DECODE(cat.tipo,'IN','71AM','71AL')) = s.struttura
  AND cat.cod_cat                                            = m.categoria
  AND scat.tbctc_cod_cat(+)                                  = m.categoria
  AND scat.progr(+)                                          = m.sotto_cat
  AND det.tsp_tbctc_cod_cat(+)                               = m.categoria
  AND det.tsp_progr(+)                                       = m.sotto_cat
  AND det.progr(+)                                           = m.dettaglio_cat
  AND p.codice(+)                                            = det.produttore
  UNION
  SELECT DISTINCT
    cat.tipo tipo_bene,
    m.cod_inv codice_bene,
    scat.descrizione sottocategoria,
    p.descrizione produttore,
    det.descrizione modello,
    m.descr_agg descr_bene,
    a.ass_matricola,
    (a.ass_cognome
    ||' '
    ||a.ass_nome) utente,
    REPLACE(NVL(s.dipartimento,'71')
    ||' - '
    ||NVL(s.desc_dipartimento,'DIPARTIMENTO PRESIDENZA GIUNTA'),'''','')
    dipartimento, --NVL(SUBSTR(a.ass_ufficio,1,2),'71') dipartimento,
    REPLACE(DECODE( NVL(s.struttura,DECODE(cat.tipo,'IN','71AM','71AL')) ,
    '800D','80D',NVL(s.struttura,DECODE(cat.tipo,'IN','71AM','71AL')) )
    ||' - '
    ||s.descrizione,'''','') ufficio,
    i.data_doc data_acquisto,
    NVL(r.pr_unit,0) *(1-NVL(r.perc_sconto,0)/100)*(1+NVL(to_number(
    r.tbi_cod_iva),0)/100) costo_bene,
    to_number(r.tbi_cod_iva) perc_iva,
    to_number(r.perc_sconto) perc_sconto,
    NVL(r.pr_unit,0) prezzo_unitario,
    m.bf_numero numero_fattura,
    'B' f_b,
    m.rfid
  FROM
    tb_beni_mobili m ,
    tb_cat_cesp cat,
    tb_scat_cesp scat,
    tb_dett_scat det ,
    hs_produttori p ,
    tb_bolla b ,
    tb_righi_bolla rb,
    tb_fattura_bolla fb,
    tb_doc_iva i,
    tb_righi_doc r,
    vw_dipartimenti_strutture s,
    tb_beni_ass a
  WHERE
    NVL(m.bf_tipo,'X')                                       = 'B'
  AND m.bf_numero                                            = b.numero
  AND m.bf_fornitore                                         = b.fornitore
  AND b.numero                                               = rb.tb_numero
  AND b.data                                                 = rb.tb_data
  AND b.fornitore                                            = rb.tb_fornitore
  AND m.bf_progr_rigo                                        = rb.progressivo
  AND b.numero                                               = fb.numero
  AND b.data                                                 = fb.data
  AND fb.bolla_buono                                         = 'BOL'
  AND fb.id_fattura                                          = i.chiave
  AND i.chiave                                               = r.tbdi_tbtd_chiave
  AND NVL(rb.categoria,r.cat)                                = r.cat
  AND NVL(rb.scategoria,r.scat)                              = r.scat
  AND rb.dettaglio                                           = r.tba_id
  AND a.codice(+)                                            = m.cod_inv
  AND a.data_fine_ass(+)                                    IS NULL
  AND NVL(a.ass_ufficio,DECODE(cat.tipo,'IN','71AM','71AL')) = s.struttura
  AND cat.cod_cat                                            = m.categoria
  AND scat.tbctc_cod_cat(+)                                  = m.categoria
  AND scat.progr(+)                                          = m.sotto_cat
  AND det.tsp_tbctc_cod_cat(+)                               = m.categoria
  AND det.tsp_progr(+)                                       = m.sotto_cat
  AND det.progr(+)                                           = m.dettaglio_cat
  AND p.codice(+)                                            = det.produttore
</td>
	</tr>
	<tr>
<td>QUERY_LEN</td>
<td>5282</td>
	</tr>
	<tr>
<td>UPDATABLE</td>
<td>N</td>
	</tr>
	<tr>
<td>UPDATE_LOG</td>
<td>null</td>
	</tr>
	<tr>
<td>MASTER_ROLLBACK_SEG</td>
<td>null</td>
	</tr>
	<tr>
<td>MASTER_LINK</td>
<td>null</td>
	</tr>
	<tr>
<td>REWRITE_ENABLED</td>
<td>N</td>
	</tr>
	<tr>
<td>REWRITE_CAPABILITY</td>
<td>TEXTMATCH</td>
	</tr>
	<tr>
<td>REFRESH_MODE</td>
<td>DEMAND</td>
	</tr>
	<tr>
<td>REFRESH_METHOD</td>
<td>COMPLETE</td>
	</tr>
	<tr>
<td>BUILD_MODE</td>
<td>IMMEDIATE</td>
	</tr>
	<tr>
<td>FAST_REFRESHABLE</td>
<td>NO</td>
	</tr>
	<tr>
<td>LAST_REFRESH_TYPE</td>
<td>COMPLETE</td>
	</tr>
	<tr>
<td>LAST_REFRESH_DATE</td>
<td>2011-12-07</td>
	</tr>
	<tr>
<td>STALENESS</td>
<td>NEEDS_COMPILE</td>
	</tr>
	<tr>
<td>AFTER_FAST_REFRESH</td>
<td>NEEDS_COMPILE</td>
	</tr>
	<tr>
<td>UNKNOWN_PREBUILT</td>
<td>N</td>
	</tr>
	<tr>
<td>UNKNOWN_PLSQL_FUNC</td>
<td>N</td>
	</tr>
	<tr>
<td>UNKNOWN_EXTERNAL_TABLE</td>
<td>N</td>
	</tr>
	<tr>
<td>UNKNOWN_CONSIDER_FRESH</td>
<td>N</td>
	</tr>
	<tr>
<td>UNKNOWN_IMPORT</td>
<td>Y</td>
	</tr>
	<tr>
<td>UNKNOWN_TRUSTED_FD</td>
<td>N</td>
	</tr>
	<tr>
<td>COMPILE_STATE</td>
<td>NEEDS_COMPILE</td>
	</tr>
	<tr>
<td>USE_NO_INDEX</td>
<td>N</td>
	</tr>
	<tr>
<td>STALE_SINCE</td>
<td>2020-05-01</td>
	</tr>
	<tr>
<td>NUM_PCT_TABLES</td>
<td>0</td>
	</tr>
	<tr>
<td>NUM_FRESH_PCT_REGIONS</td>
<td>null</td>
	</tr>
	<tr>
<td>NUM_STALE_PCT_REGIONS</td>
<td>null</td>
	</tr>
</table></div>