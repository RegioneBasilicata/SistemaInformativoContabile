<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=Cp1252" />
<script src="../dbdoc.js" type="text/javascript"></script>
<link href="../dbdoc.css" type="text/css" rel="stylesheet">
</head>
<body class="object">
<div id="header"><h2>BDAP</h2>
<div class="tabs clearfix">

<div class="tab"><div><a href="BDAP.html">Details</a></div></div>
<div class="tab"><div><a href="BDAP_Grants.html">Grants</a></div></div>
<div class="tab"><div><a href="BDAP_References.html">References</a></div></div>
<div class="tab"><div><a href="BDAP_Dependencies.html">Dependencies</a></div></div>
<div class="tab" id="current"><div><a href="BDAP_Code.html">Code</a></div></div>
</div></div><br/>
<div class="tab-panes">
<div id="Code"> <table cellpadding="0" cellspacing="0" cellspacing="0" summary=""><tr>
	<th>TEXT</th>
</tr>
	<tr><td><pre>
procedure bdap(p_anno in number,p_utente in varchar2,p_id_ente in varchar2) as


c_riga     number; -- conta le righe

-- **** Variabili per SDB Schemi di Bilancio 
suffisso varchar2(50); -- utilizzato per alcuni cursori al fine di modificare dinamicamente il tag.
parametro_where varchar2(50); -- parametro utilizzato per alcune condizioni di where. Il valore viene settato dinamicamente. (vedi sdb_e_1 ed sdb_e_2)
--*** FIne Sezione Variabili Schemi di Bilanco

-- ******* variabili per indicatori bilancio PREV
tot_CompEnt             varchar2(2000);
tot_CompeEntMediaAcc    varchar2(2000);
tot_Risc                 varchar2(2000);
tot_RiscMedia              varchar2(2000);
tot_CompEnt2             varchar2(2000);
tot_CompEnt3             varchar2(2000);
-- ******* FINE Variabili Indicatori Bilancio Prev 

-- **** Sezione variabili per FCDDE, VINCOLI FINANZA PUBBLICA E LIMITI DI INDEBITAMENTO
v_contenuto1 VARCHAR2(4000);
v_contenuto2 VARCHAR2(4000);

v_contenuto VARCHAR2(4000);
v_tit VARCHAR2(1);
v1 VARCHAR2(100);
v2 VARCHAR2(100);
-- **** Fine Sezione variabili per FCDDE, VINCOLI FINANZA PUBBLICA E LIMITI DI INDEBITAMENTO

--*** Sezione DCA Dati COntabili Analitici
cursor bdca_e is 
select
 PIANO_CONTI_FINA pcf1
,'    &lt;dp:vocePDCI contextRef="d_'||p_anno||'">'||PIANO_CONTI_FINA||'&lt;/dp:vocePDCI>'  pcf
,'    &lt;dp:RS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))||'&lt;/dp:RS>' rs_prec
,'    &lt;dp:CP decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00'))||'&lt;/dp:CP>' cp_prec
,'    &lt;dp:CP decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))||'&lt;/dp:CP>' cp_anno0
,'    &lt;dp:CP decimals="2" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))||'&lt;/dp:CP>' cp_anno1
,'    &lt;dp:CP decimals="2" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))||'&lt;/dp:CP>' cp_anno2
,'    &lt;dp:CS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00'))||'&lt;/dp:CS>' cs_prec
,'    &lt;dp:CS decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))||'&lt;/dp:CS>' cs_anno0
from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='E'
and PIANO_CONTI_FINA is not null
group by piano_conti_fina
order by 1;

cursor bdca_u is 
select 
 PIANO_CONTI_FINA pcf1
,ETITOLO_UMISSIONE miss1
,ETIPOLOGIA_UPROGRAMMA prog1
,'    &lt;dp:vocePDCI contextRef="d_'||p_anno||'">'||PIANO_CONTI_FINA||'&lt;/dp:vocePDCI>'  pcf
,'    &lt;dp:miss contextRef="d_'||p_anno||'">'||ETITOLO_UMISSIONE||'&lt;/dp:miss>' miss
,'    &lt;dp:prog contextRef="d_'||p_anno||'">'||ETIPOLOGIA_UPROGRAMMA||'&lt;/dp:prog>' prog
,'    &lt;dp:RS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))              ||'&lt;/dp:RS>' rs_prec
,'    &lt;dp:CP decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/dp:CP>' cp_prec
,'    &lt;dp:CP decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))     ||'&lt;/dp:CP>' cp_anno0
,'    &lt;dp:CP decimals="2" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))     ||'&lt;/dp:CP>' cp_anno1
,'    &lt;dp:CP decimals="2" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))     ||'&lt;/dp:CP>' cp_anno2

,'    &lt;dp:CP-IMP decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO_PREC,0)),'9999999990.00'))||'&lt;/dp:CP-IMP>' dicui_imp_anno_prec
,'    &lt;dp:CP-IMP decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO0,0)),'9999999990.00'))    ||'&lt;/dp:CP-IMP>' dicui_imp_anno0
,'    &lt;dp:CP-IMP decimals="2" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO1,0)),'9999999990.00'))    ||'&lt;/dp:CP-IMP>' dicui_imp_anno1
,'    &lt;dp:CP-IMP decimals="2" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO2,0)),'9999999990.00'))    ||'&lt;/dp:CP-IMP>' dicui_imp_anno2

,'    &lt;dp:CP-FPV decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO_PREC,0)),'9999999990.00'))  ||'&lt;/dp:CP-FPV>' dicui_fpv_anno_prec
,'    &lt;dp:CP-FPV decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO0,0)),'9999999990.00'))      ||'&lt;/dp:CP-FPV>' dicui_fpv_anno0
,'    &lt;dp:CP-FPV decimals="2" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO1,0)),'9999999990.00'))      ||'&lt;/dp:CP-FPV>' dicui_fpv_anno1
,'    &lt;dp:CP-FPV decimals="2" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO2,0)),'9999999990.00'))      ||'&lt;/dp:CP-FPV>' dicui_fpv_anno2

,'    &lt;dp:CS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00'))  ||'&lt;/dp:CS>' cs_prec
,'    &lt;dp:CS decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))      ||'&lt;/dp:CS>' cs_anno0

from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='U'
and PIANO_CONTI_FINA is not null
group by piano_conti_fina,etitolo_umissione,etipologia_uprogramma
order by 1,2,3;
--*** Fine Sezione DCA Dati COntabili Analitici


--*** Inizio Sezione Cursori per SDB Schemi Di Bilancio
cursor sdb_e_testata is -- testata
select 
 riga
,competenza_anno_prec
,competenza_anno0
,competenza_anno1
,competenza_anno2
,cassa_anno_prec
,cassa_anno0
from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='E'
and riga in (1,2,3,4,6)
order by 1;

cursor sdb_e_1_1 is -- dettaglio1
select 
 '  &lt;sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_RS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))                ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_RS>' rs_prec
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CP decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00'))   ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CP>' cp_prec
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CP decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))       ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CP>' cp_anno0
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CP decimals="2" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))       ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CP>' cp_anno1
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CP decimals="2" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))       ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CP>' cp_anno2
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00'))        ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CS>' cs_prec
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CS decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))            ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,9)||'.00.000_CS>' cs_anno0
from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='E'
and PIANO_CONTI_FINA is not null
and substr(piano_conti_fina,1,3) in parametro_where
and substr(piano_conti_fina,1,3) in ('E.1','E.2')
group by substr(piano_conti_fina,1,9)
order by 1;

cursor sdb_e_1_2 is -- dettaglio2
select 
 '  &lt;sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_RS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))                ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_RS>' rs_prec
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CP decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00'))   ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CP>' cp_prec
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CP decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))       ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CP>' cp_anno0
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CP decimals="2" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))       ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CP>' cp_anno1
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CP decimals="2" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))       ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CP>' cp_anno2
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00'))        ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CS>' cs_prec
,'  &lt;sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CS decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))            ||'&lt;/sp:ENT_'||substr(piano_conti_fina,1,6)||'.00.00.000_CS>' cs_anno0
from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='E'
and PIANO_CONTI_FINA is not null
and substr(piano_conti_fina,1,3) in parametro_where
and substr(piano_conti_fina,1,3) not in ('E.1','E.2')
group by substr(piano_conti_fina,1,6)
order by 1;

cursor sdb_e_2 is -- totale singolo titolo
select
 substr(piano_conti_fina,1,3) pcf 
,'  &lt;sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_RS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))             ||'&lt;/sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_RS>' rs_prec
,'  &lt;sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00'))||'&lt;/sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_prec
,'  &lt;sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))    ||'&lt;/sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_anno0
,'  &lt;sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))    ||'&lt;/sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_anno1
,'  &lt;sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))    ||'&lt;/sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_anno2
,'  &lt;sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00'))     ||'&lt;/sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS>' cs_prec
,'  &lt;sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))         ||'&lt;/sp:ENT'||suffisso||'_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS>' cs_anno0
from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='E'
and PIANO_CONTI_FINA is not null
group by substr(piano_conti_fina,1,3)
order by 1;

cursor sdb_e_3 is  -- totale per titoli
select 
 '  &lt;sp:ENT'||suffisso||'_TotaleTitoli_RS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))             ||'&lt;/sp:ENT'||suffisso||'_TotaleTitoli_RS>' rs_prec
,'  &lt;sp:ENT'||suffisso||'_TotaleTitoli_CP decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00'))||'&lt;/sp:ENT'||suffisso||'_TotaleTitoli_CP>' cp_prec
,'  &lt;sp:ENT'||suffisso||'_TotaleTitoli_CP decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))    ||'&lt;/sp:ENT'||suffisso||'_TotaleTitoli_CP>' cp_anno0
,'  &lt;sp:ENT'||suffisso||'_TotaleTitoli_CP decimals="2" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))    ||'&lt;/sp:ENT'||suffisso||'_TotaleTitoli_CP>' cp_anno1
,'  &lt;sp:ENT'||suffisso||'_TotaleTitoli_CP decimals="2" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))    ||'&lt;/sp:ENT'||suffisso||'_TotaleTitoli_CP>' cp_anno2
,'  &lt;sp:ENT'||suffisso||'_TotaleTitoli_CS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00'))     ||'&lt;/sp:ENT'||suffisso||'_TotaleTitoli_CS>' cs_prec
,'  &lt;sp:ENT'||suffisso||'_TotaleTitoli_CS decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))         ||'&lt;/sp:ENT'||suffisso||'_TotaleTitoli_CS>' cs_anno0
from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='E'
and PIANO_CONTI_FINA is not null
order by 1;

cursor sdb_e_4 is -- totale generale
select 
 '  &lt;sp:ENT'||suffisso||'_TotaleGenerale_RS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))             ||'&lt;/sp:ENT'||suffisso||'_TotaleGenerale_RS>' rs_prec
,'  &lt;sp:ENT'||suffisso||'_TotaleGenerale_CP decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00'))||'&lt;/sp:ENT'||suffisso||'_TotaleGenerale_CP>' cp_prec
,'  &lt;sp:ENT'||suffisso||'_TotaleGenerale_CP decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))    ||'&lt;/sp:ENT'||suffisso||'_TotaleGenerale_CP>' cp_anno0
,'  &lt;sp:ENT'||suffisso||'_TotaleGenerale_CP decimals="2" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))    ||'&lt;/sp:ENT'||suffisso||'_TotaleGenerale_CP>' cp_anno1
,'  &lt;sp:ENT'||suffisso||'_TotaleGenerale_CP decimals="2" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))    ||'&lt;/sp:ENT'||suffisso||'_TotaleGenerale_CP>' cp_anno2
,'  &lt;sp:ENT'||suffisso||'_TotaleGenerale_CS decimals="2" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00'))     ||'&lt;/sp:ENT'||suffisso||'_TotaleGenerale_CS>' cs_prec
,'  &lt;sp:ENT'||suffisso||'_TotaleGenerale_CS decimals="2" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))         ||'&lt;/sp:ENT'||suffisso||'_TotaleGenerale_CS>' cs_anno0
from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='E'
and riga not in (4,5) -- Gerry 29.06.2018 - Prendeva in considerazione anche i "di cui" incrementando il totale generale erroneamente.
order by 1;


--uscite
cursor sdb_u_testata is -- testata
select 
 riga
,competenza_anno_prec
,competenza_anno0
,competenza_anno1
,competenza_anno2
,cassa_anno_prec
,cassa_anno0
from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='U'
and riga in (1,2)
order by 1;


cursor sdb_u_1 is  -- missioni/programmi/pcf
select 
 ETITOLO_UMISSIONE miss
,ETIPOLOGIA_UPROGRAMMA prog
,substr(piano_conti_fina,1,3) pcf
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_RS decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))              ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_RS>' rs_prec
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_anno2
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_prec
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_anno0
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_anno1

,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP>' dicui_imp_anno_prec
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP>' dicui_imp_anno0
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP>' dicui_imp_anno1
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP>' dicui_imp_anno2

,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV>' dicui_FPV_anno_prec
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV>' dicui_FPV_anno0
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV>' dicui_FPV_anno1
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV>' dicui_FPV_anno2

,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS>' cs_prec
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'-'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS>' cs_anno0

from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='U'
and PIANO_CONTI_FINA is not null
group by anno,etitolo_umissione,etipologia_uprogramma,substr(piano_conti_fina,1,3)
order by 1,2,3;

cursor sdb_u_2 is  -- solo missioni/programmi
select 
 ETITOLO_UMISSIONE miss
,ETIPOLOGIA_UPROGRAMMA prog
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_RS decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))              ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_RS>' rs_prec
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP>' cp_prec

,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP>' cp_anno0
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP>' cp_anno1
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP>' cp_anno2
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-IMP decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-IMP>' dicui_imp_anno_prec
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-IMP decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-IMP>' dicui_imp_anno0
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-IMP decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-IMP>' dicui_imp_anno1
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-IMP decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-IMP>' dicui_imp_anno2

,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-FPV decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-FPV>' dicui_FPV_anno_prec
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-FPV decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-FPV>' dicui_FPV_anno0
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-FPV decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-FPV>' dicui_FPV_anno1
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-FPV decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CP-FPV>' dicui_FPV_anno2

,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CS decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CS>' cs_prec
,'  &lt;sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CS decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Prog'||ETITOLO_UMISSIONE||'.'||ETIPOLOGIA_UPROGRAMMA||'_CS>' cs_anno0

from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='U'
and PIANO_CONTI_FINA is not null
group by anno,etitolo_umissione,etipologia_uprogramma
order by 1,2;

cursor sdb_u_3 is  -- solo missioni
select 
 ETITOLO_UMISSIONE miss
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_RS decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))              ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_RS>' rs_prec
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP>' cp_prec
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP>' cp_anno0
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP>' cp_anno1
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP>' cp_anno2

,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-IMP decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-IMP>' dicui_imp_anno_prec
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-IMP decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-IMP>' dicui_imp_anno0
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-IMP decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-IMP>' dicui_imp_anno1
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-IMP decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-IMP>' dicui_imp_anno2

,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-FPV decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-FPV>' dicui_FPV_anno_prec

,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-FPV decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-FPV>' dicui_FPV_anno0
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-FPV decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-FPV>' dicui_FPV_anno1
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-FPV decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CP-FPV>' dicui_FPV_anno2
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CS decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CS>' cs_prec
,'  &lt;sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CS decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE_Miss'||ETITOLO_UMISSIONE||'_CS>' cs_anno0

from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='U'
and PIANO_CONTI_FINA is not null
group by anno,etitolo_umissione
order by 1;

cursor sdb_u_4 is  -- totale missioni (senza il disavanzo eventuale)
select 
 '  &lt;sp:SPE'||suffisso||'_RS decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))              ||'&lt;/sp:SPE'||suffisso||'_RS>' rs_prec
,'  &lt;sp:SPE'||suffisso||'_CP decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE'||suffisso||'_CP>' cp_prec
,'  &lt;sp:SPE'||suffisso||'_CP decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_CP>' cp_anno0
,'  &lt;sp:SPE'||suffisso||'_CP decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_CP>' cp_anno1
,'  &lt;sp:SPE'||suffisso||'_CP decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_CP>' cp_anno2

,'  &lt;sp:SPE'||suffisso||'_CP-IMP decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE'||suffisso||'_CP-IMP>' dicui_imp_anno_prec
,'  &lt;sp:SPE'||suffisso||'_CP-IMP decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_CP-IMP>' dicui_imp_anno0
,'  &lt;sp:SPE'||suffisso||'_CP-IMP decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_CP-IMP>' dicui_imp_anno1
,'  &lt;sp:SPE'||suffisso||'_CP-IMP decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_CP-IMP>' dicui_imp_anno2

,'  &lt;sp:SPE'||suffisso||'_CP-FPV decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE'||suffisso||'_CP-FPV>' dicui_FPV_anno_prec
,'  &lt;sp:SPE'||suffisso||'_CP-FPV decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_CP-FPV>' dicui_FPV_anno0
,'  &lt;sp:SPE'||suffisso||'_CP-FPV decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_CP-FPV>' dicui_FPV_anno1
,'  &lt;sp:SPE'||suffisso||'_CP-FPV decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_CP-FPV>' dicui_FPV_anno2

,'  &lt;sp:SPE'||suffisso||'_CS decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE'||suffisso||'_CS>' cs_prec
,'  &lt;sp:SPE'||suffisso||'_CS decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_CS>' cs_anno0

from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='U'
and PIANO_CONTI_FINA is not null
group by anno
order by 1;

cursor sdb_u_5 is  -- totale generale /include i record con pcf null -disavanzo
select 
 '  &lt;sp:SPE'||suffisso||'_TotaleGenerale_RS decimals="2" contextRef="d_'    ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))                   ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_RS>' rs_prec
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP decimals="2" contextRef="d_'    ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00'))      ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP>' cp_prec
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP decimals="2" contextRef="d_'    ||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))          ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP>' cp_anno0
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP decimals="2" contextRef="d_'    ||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))          ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP>' cp_anno1
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP decimals="2" contextRef="d_'    ||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))          ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP>' cp_anno2

,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP-IMP decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP-IMP>' dicui_imp_anno_prec

,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP-IMP decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP-IMP>' dicui_imp_anno0
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP-IMP decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP-IMP>' dicui_imp_anno1
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP-IMP decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP-IMP>' dicui_imp_anno2
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP-FPV decimals="2" contextRef="d_'||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO_PREC,0)),'9999999990.00'))       ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP-FPV>' dicui_FPV_anno_prec
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP-FPV decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO0,0)),'9999999990.00'))           ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP-FPV>' dicui_FPV_anno0
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP-FPV decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO1,0)),'9999999990.00'))           ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP-FPV>' dicui_FPV_anno1
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CP-FPV decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO2,0)),'9999999990.00'))           ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CP-FPV>' dicui_FPV_anno2

,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CS decimals="2" contextRef="d_'    ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00'))           ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CS>' cs_prec
,'  &lt;sp:SPE'||suffisso||'_TotaleGenerale_CS decimals="2" contextRef="d_'    ||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))               ||'&lt;/sp:SPE'||suffisso||'_TotaleGenerale_CS>' cs_anno0
from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='U'
group by anno
order by 1;


cursor sdb_u_tit_1 is  -- pcf
select 
 substr(piano_conti_fina,1,3) pcf
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_RS decimals="2" contextRef="d_'      ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))                   ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_RS>' rs_prec
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'      ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00'))      ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_prec
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'      ||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))          ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_anno0
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'      ||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))          ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_anno1
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP decimals="2" contextRef="d_'      ||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))          ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP>' cp_anno2

,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP decimals="2" contextRef="d_'  ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP>' dicui_imp_anno_prec
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP decimals="2" contextRef="d_'  ||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP>' dicui_imp_anno0
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP decimals="2" contextRef="d_'  ||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP>' dicui_imp_anno1
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP decimals="2" contextRef="d_'  ||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-IMP>' dicui_imp_anno2

,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV decimals="2" contextRef="d_'  ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO_PREC,0)),'9999999990.00'))       ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV>' dicui_FPV_anno_prec
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV decimals="2" contextRef="d_'  ||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO0,0)),'9999999990.00'))           ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV>' dicui_FPV_anno0
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV decimals="2" contextRef="d_'  ||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO1,0)),'9999999990.00'))           ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV>' dicui_FPV_anno1
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV decimals="2" contextRef="d_'  ||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO2,0)),'9999999990.00'))           ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CP-FPV>' dicui_FPV_anno2

from fin_t_previsione 
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS decimals="2" contextRef="d_'      ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00'))           ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS>' cs_prec
,'  &lt;sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS decimals="2" contextRef="d_'      ||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))               ||'&lt;/sp:SPE-TIT_'||substr(piano_conti_fina,1,3)||'.00.00.00.000_CS>' cs_anno0

where utente=p_utente
and anno=p_anno
and eu='U'
and PIANO_CONTI_FINA is not null
group by anno,substr(piano_conti_fina,1,3)
order by 1,2,3;

cursor sdb_u_mis_1 is  -- Missione
select 
  ETITOLO_UMISSIONE miss
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_RS decimals="2" contextRef="d_'      ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(RESIDUO,0)),'9999999990.00'))                   ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_RS>' rs_prec
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP decimals="2" contextRef="d_'      ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO_PREC,0)),'9999999990.00'))      ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP>' cp_prec
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP decimals="2" contextRef="d_'      ||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO0,0)),'9999999990.00'))          ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP>' cp_anno0
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP decimals="2" contextRef="d_'      ||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO1,0)),'9999999990.00'))          ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP>' cp_anno1
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP decimals="2" contextRef="d_'      ||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(COMPETENZA_ANNO2,0)),'9999999990.00'))          ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP>' cp_anno2

,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-IMP decimals="2" contextRef="d_'  ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO_PREC,0)),'9999999990.00')) ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-IMP>' dicui_imp_anno_prec
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-IMP decimals="2" contextRef="d_'  ||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO0,0)),'9999999990.00'))     ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-IMP>' dicui_imp_anno0
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-IMP decimals="2" contextRef="d_'  ||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO1,0)),'9999999990.00'))     ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-IMP>' dicui_imp_anno1
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-IMP decimals="2" contextRef="d_'  ||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_IMPEGNATO_ANNO2,0)),'9999999990.00'))     ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-IMP>' dicui_imp_anno2

,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-FPV decimals="2" contextRef="d_'  ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO_PREC,0)),'9999999990.00'))       ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-FPV>' dicui_FPV_anno_prec
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-FPV decimals="2" contextRef="d_'  ||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO0,0)),'9999999990.00'))           ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-FPV>' dicui_FPV_anno0
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-FPV decimals="2" contextRef="d_'  ||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO1,0)),'9999999990.00'))           ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-FPV>' dicui_FPV_anno1
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-FPV decimals="2" contextRef="d_'  ||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(DICUI_FPV_ANNO2,0)),'9999999990.00'))           ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CP-FPV>' dicui_FPV_anno2

,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CS decimals="2" contextRef="d_'      ||(anno - 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO_PREC,0)),'9999999990.00'))           ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CS>' cs_prec
,'  &lt;sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CS decimals="2" contextRef="d_'      ||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(CASSA_ANNO0,0)),'9999999990.00'))               ||'&lt;/sp:SPE-MIS_Miss'||ETITOLO_UMISSIONE||'_CS>' cs_anno0

from fin_t_previsione 
where utente=p_utente
and anno=p_anno
and eu='U'
and PIANO_CONTI_FINA is not null
group by anno,ETITOLO_UMISSIONE
order by 1,2,3;

cursor sdb_tdrap is  -- Tabella Dimostrativa Risultato Amministrazione Presunto
select 
 '  &lt;'||tag_bdap||' decimals="2" contextRef="d_'||(anno)||'" unitRef="eur">'||ltrim(to_char(nvl(VALORE,0),'9999999990.00'))||'&lt;/'||tag_bdap||'>' tdrap
from fin_t_previsione_tdrap 
where utente='PREV'||p_anno
and substr(tag_bdap,1,8)&lt;> 'ABSTRACT'
and anno=p_anno
order by riga;

cursor sdb_fpv_miss is  -- Fondo Pluriennale Missioni
select 
 MISSIONE
,'  &lt;sp:FPV_Miss'||MISSIONE||'_FPVEsercizioPrec         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(A0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_FPVEsercizioPrec>' A0
,'  &lt;sp:FPV_Miss'||MISSIONE||'_FPVEsercizioPrec         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(A1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_FPVEsercizioPrec>' A1
,'  &lt;sp:FPV_Miss'||MISSIONE||'_FPVEsercizioPrec         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(A2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_FPVEsercizioPrec>' A2


,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioPrec     decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(B0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioPrec>' B0
,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioPrec     decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(B1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioPrec>' B1
,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioPrec     decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(B2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioPrec>' B2
,'  &lt;sp:FPV_Miss'||MISSIONE||'_QuotaRinviata             decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(C0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_QuotaRinviata>' C0
,'  &lt;sp:FPV_Miss'||MISSIONE||'_QuotaRinviata             decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(C1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_QuotaRinviata>' C1
,'  &lt;sp:FPV_Miss'||MISSIONE||'_QuotaRinviata             decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(C2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_QuotaRinviata>' C2

,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio1         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(D0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio1>' D0
,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio1         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(D1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio1>' D1
,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio1         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(D2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio1>' D2

,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio2         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(E0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio2>' E0
,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio2         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(E1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio2>' E1
,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio2         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(E2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizio2>' E2

,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioN         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(F0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioN>' F0
,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioN         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(F1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioN>' F1
,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioN         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(F2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpEsercizioN>' F2

,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpND                 decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(G0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpND>' G0
,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpND                 decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(G1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpND>' G1
,'  &lt;sp:FPV_Miss'||MISSIONE||'_SpeseImpND                 decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(G2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_SpeseImpND>' G2

,'  &lt;sp:FPV_Miss'||MISSIONE||'_FPVEsercizio             decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(H0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_FPVEsercizio>' H0
,'  &lt;sp:FPV_Miss'||MISSIONE||'_FPVEsercizio             decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(H1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_FPVEsercizio>' H1
,'  &lt;sp:FPV_Miss'||MISSIONE||'_FPVEsercizio             decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(H2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Miss'||MISSIONE||'_FPVEsercizio>' H2
from fin_t_previsione_fpv 
where utente='PREV'||p_anno
and anno=p_anno
group by missione,anno
order by 1;

cursor sdb_fpv_prog is  -- Fondo Pluriennale Programma
select 
 MISSIONE
,PROGRAMMA
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizioPrec         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(A0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizioPrec>' A0
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizioPrec         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(A1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizioPrec>' A1
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizioPrec         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(A2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizioPrec>' A2

,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioPrec     decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(B0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioPrec>' B0
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_QuotaRinviata             decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(C0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_QuotaRinviata>' C0
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioPrec     decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(B1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioPrec>' B1
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioPrec     decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(B2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioPrec>' B2

,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_QuotaRinviata             decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(C1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_QuotaRinviata>' C1
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_QuotaRinviata             decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(C2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_QuotaRinviata>' C2

,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio1         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(D0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio1>' D0
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio1         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(D1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio1>' D1
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio1         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(D2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio1>' D2

,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio2         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(E0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio2>' E0
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio2         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(E1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio2>' E1
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio2         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(E2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizio2>' E2

,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioN         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(F0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioN>' F0
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioN         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(F1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioN>' F1
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioN         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(F2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpEsercizioN>' F2

,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpND                 decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(G0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpND>' G0
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpND                 decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(G1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpND>' G1
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpND                 decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(G2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_SpeseImpND>' G2

,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizio             decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(H0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizio>' H0
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizio             decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(H1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizio>' H1
,'  &lt;sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizio             decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(H2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_Prog'||MISSIONE||'.'||PROGRAMMA||'_FPVEsercizio>' H2
from fin_t_previsione_fpv 
where utente='PREV'||p_anno
and anno=p_anno
group by missione,programma,anno
order by 1,2;

cursor sdb_fpv_tot is  -- Totali Fondo Pluriennale 
select 
 '  &lt;sp:FPV_TotaleMissioni_FPVEsercizioPrec         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(A0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_FPVEsercizioPrec>' A0
,'  &lt;sp:FPV_TotaleMissioni_FPVEsercizioPrec         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(A1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_FPVEsercizioPrec>' A1
,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizioPrec     decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(B1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizioPrec>' B1
,'  &lt;sp:FPV_TotaleMissioni_FPVEsercizioPrec         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(A2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_FPVEsercizioPrec>' A2

,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizioPrec     decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(B0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizioPrec>' B0
,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizioPrec     decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(B2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizioPrec>' B2

,'  &lt;sp:FPV_TotaleMissioni_QuotaRinviata             decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(C0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_QuotaRinviata>' C0
,'  &lt;sp:FPV_TotaleMissioni_QuotaRinviata             decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(C1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_QuotaRinviata>' C1
,'  &lt;sp:FPV_TotaleMissioni_QuotaRinviata             decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(C2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_QuotaRinviata>' C2

,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizio1         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(D0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizio1>' D0
,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizio1         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(D1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizio1>' D1
,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizio1         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(D2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizio1>' D2

,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizio2         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(E0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizio2>' E0
,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizio2         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(E1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizio2>' E1
,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizio2         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(E2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizio2>' E2

,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizioN         decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(F0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizioN>' F0
,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizioN         decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(F1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizioN>' F1
,'  &lt;sp:FPV_TotaleMissioni_SpeseImpEsercizioN         decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(F2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpEsercizioN>' F2

,'  &lt;sp:FPV_TotaleMissioni_SpeseImpND                 decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(G0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpND>' G0
,'  &lt;sp:FPV_TotaleMissioni_SpeseImpND                 decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(G1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpND>' G1
,'  &lt;sp:FPV_TotaleMissioni_SpeseImpND                 decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(G2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_SpeseImpND>' G2

,'  &lt;sp:FPV_TotaleMissioni_FPVEsercizio             decimals="2" contextRef="d_'||(anno + 0)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(H0,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_FPVEsercizio>' H0
,'  &lt;sp:FPV_TotaleMissioni_FPVEsercizio             decimals="2" contextRef="d_'||(anno + 1)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(H1,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_FPVEsercizio>' H1
,'  &lt;sp:FPV_TotaleMissioni_FPVEsercizio             decimals="2" contextRef="d_'||(anno + 2)||'" unitRef="eur">'||ltrim(to_char(sum(nvl(H2,0)),'9999999990.00'))              ||'&lt;/sp:FPV_TotaleMissioni_FPVEsercizio>' H2
from fin_t_previsione_fpv 
where utente='PREV'||p_anno
and anno=p_anno
group by anno;


cursor sdb_qgr is  -- Quadro Generale Riassuntivo 
select 
 decode (e_tag_bdap_cassa,null,null,'  &lt;sp:'||e_tag_bdap_cassa||' decimals="2" contextRef="d_'||(anno +0)||'" unitRef="eur">'||ltrim(to_char(nvl(E_CASSA,0),'9999999990.00'))||'&lt;/sp:'||e_tag_bdap_cassa||'>') qgr_e_cassa
,decode (u_tag_bdap_cassa,null,null,'  &lt;sp:'||u_tag_bdap_cassa||' decimals="2" contextRef="d_'||(anno +0)||'" unitRef="eur">'||ltrim(to_char(nvl(U_CASSA,0),'9999999990.00'))||'&lt;/sp:'||u_tag_bdap_cassa||'>') qgr_u_cassa
,decode (u_tag_bdap_anno1,null,null,'  &lt;sp:'||u_tag_bdap_anno1||' decimals="2" contextRef="d_'||(anno +1)||'" unitRef="eur">'||ltrim(to_char(nvl(U_ANNO1,0),'9999999990.00'))||'&lt;/sp:'||u_tag_bdap_anno1||'>') qgr_u_anno1
,decode (e_tag_bdap_anno0,null,null,'  &lt;sp:'||e_tag_bdap_anno0||' decimals="2" contextRef="d_'||(anno +0)||'" unitRef="eur">'||ltrim(to_char(nvl(E_ANNO0,0),'9999999990.00'))||'&lt;/sp:'||e_tag_bdap_anno0||'>') qgr_e_anno0
,decode (u_tag_bdap_anno0,null,null,'  &lt;sp:'||u_tag_bdap_anno0||' decimals="2" contextRef="d_'||(anno +0)||'" unitRef="eur">'||ltrim(to_char(nvl(U_ANNO0,0),'9999999990.00'))||'&lt;/sp:'||u_tag_bdap_anno0||'>') qgr_u_anno0
,decode (e_tag_bdap_anno1,null,null,'  &lt;sp:'||e_tag_bdap_anno1||' decimals="2" contextRef="d_'||(anno +1)||'" unitRef="eur">'||ltrim(to_char(nvl(E_ANNO1,0),'9999999990.00'))||'&lt;/sp:'||e_tag_bdap_anno1||'>') qgr_e_anno1
,decode (e_tag_bdap_anno2,null,null,'  &lt;sp:'||e_tag_bdap_anno2||' decimals="2" contextRef="d_'||(anno +2)||'" unitRef="eur">'||ltrim(to_char(nvl(E_ANNO2,0),'9999999990.00'))||'&lt;/sp:'||e_tag_bdap_anno2||'>') qgr_e_anno2
,decode (u_tag_bdap_anno2,null,null,'  &lt;sp:'||u_tag_bdap_anno2||' decimals="2" contextRef="d_'||(anno +2)||'" unitRef="eur">'||ltrim(to_char(nvl(U_ANNO2,0),'9999999990.00'))||'&lt;/sp:'||u_tag_bdap_anno2||'>') qgr_u_anno2
from fin_t_previsione_qgr
where utente='PREV'||p_anno
and anno=p_anno
order by riga;

cursor sdb_eqb is  -- Equilibri di bilancio
select 
 decode (tag_bdap,null,null,'  &lt;sp:'||tag_bdap||' decimals="2" contextRef="d_'||(anno +0)||'" unitRef="eur">'||ltrim(to_char(nvl(ANNO0,0),'9999999990.00'))||'&lt;/sp:'||tag_bdap||'>') eqb_anno0
,decode (tag_bdap,null,null,'  &lt;sp:'||tag_bdap||' decimals="2" contextRef="d_'||(anno +1)||'" unitRef="eur">'||ltrim(to_char(nvl(ANNO1,0),'9999999990.00'))||'&lt;/sp:'||tag_bdap||'>') eqb_anno1
,decode (tag_bdap,null,null,'  &lt;sp:'||tag_bdap||' decimals="2" contextRef="d_'||(anno +2)||'" unitRef="eur">'||ltrim(to_char(nvl(ANNO2,0),'9999999990.00'))||'&lt;/sp:'||tag_bdap||'>') eqb_anno2
from fin_t_previsione_eqb
where utente='PREV'||p_anno
and anno=p_anno
order by riga;
--*** Fine Sezione Cursori per SDB Schemi Di Bilancio


-- **** Sezione CURSORI per FCDDE, VINCOLI FINANZA PUBBLICA E LIMITI DI INDEBITAMENTO (fanno parte di SDB ,ma fatti da Cecco)
-- Fondo Crediti di Dubbia Esigibilit
CURSOR sdb_fcdde_tit IS
SELECT REPLACE(denominazione,'TOTALE TITOLO ') titolo,
       LTRIM(TO_CHAR(NVL(stanziamenti_bilancio,0),'9999999990.00')) Stanz,
       LTRIM(TO_CHAR(NVL(accantonamento_obbligatorio,0),'9999999990.00')) AccObbl,
       LTRIM(TO_CHAR(NVL(accantonamento_effettivo,0),'9999999990.00')) AccEff,
       LTRIM(TO_CHAR(NVL(perc_stanziam_accantonam,0),'990.00')) PercStanzAcc,
       LTRIM(TO_CHAR(NVL(stanziamenti_bilancio1,0),'9999999990.00')) Stanz1,
       LTRIM(TO_CHAR(NVL(accantonamento_obbligatorio1,0),'9999999990.00')) AccObbl1,
       LTRIM(TO_CHAR(NVL(accantonamento_effettivo1,0),'9999999990.00')) AccEff1,
       LTRIM(TO_CHAR(NVL(perc_stanziam_accantonam1,0),'990.00')) PercStanzAcc1,
       LTRIM(TO_CHAR(NVL(stanziamenti_bilancio2,0),'9999999990.00')) Stanz2,
       LTRIM(TO_CHAR(NVL(accantonamento_obbligatorio2,0),'9999999990.00')) AccObbl2,
       LTRIM(TO_CHAR(NVL(accantonamento_effettivo2,0),'9999999990.00')) AccEff2,
       LTRIM(TO_CHAR(NVL(perc_stanziam_accantonam2,0),'990.00')) PercStanzAcc2
FROM fin_t_previsione_fcdde
WHERE anno = p_anno AND
      tipo_bilancio = 'E' AND
      tipo_riga = 'P-TOTTIT'
ORDER BY 1; 

CURSOR sdb_fcdde_tip IS
SELECT tipologia_lav tip,
       REPLACE(denominazione,'TOTALE TITOLO ') titolo,
       LTRIM(TO_CHAR(NVL(stanziamenti_bilancio,0),'9999999990.00')) Stanz,
       LTRIM(TO_CHAR(NVL(accantonamento_obbligatorio,0),'9999999990.00')) AccObbl,
       LTRIM(TO_CHAR(NVL(accantonamento_effettivo,0),'9999999990.00')) AccEff,
       LTRIM(TO_CHAR(NVL(perc_stanziam_accantonam,0),'990.00')) PercStanzAcc,
       LTRIM(TO_CHAR(NVL(stanziamenti_bilancio1,0),'9999999990.00')) Stanz1,
       LTRIM(TO_CHAR(NVL(accantonamento_obbligatorio1,0),'9999999990.00')) AccObbl1,
       LTRIM(TO_CHAR(NVL(accantonamento_effettivo1,0),'9999999990.00')) AccEff1,
       LTRIM(TO_CHAR(NVL(perc_stanziam_accantonam1,0),'990.00')) PercStanzAcc1,
       LTRIM(TO_CHAR(NVL(stanziamenti_bilancio2,0),'9999999990.00')) Stanz2,
       LTRIM(TO_CHAR(NVL(accantonamento_obbligatorio2,0),'9999999990.00')) AccObbl2,
       LTRIM(TO_CHAR(NVL(accantonamento_effettivo2,0),'9999999990.00')) AccEff2,
       LTRIM(TO_CHAR(NVL(perc_stanziam_accantonam2,0),'990.00')) PercStanzAcc2,
       tipo_riga
FROM fin_t_previsione_fcdde
WHERE anno = p_anno AND
      tipo_bilancio = 'E' AND
      tipo_riga IN ('B-TIPOLOGIA',
                    'B1-DICUIACCPERCASSA','B1-DICUINONACCPERCASSA',
                    'B1-TRASFUE','B1-TRASFRESTOM',
                    'B1-CONTRINVAMMPUB','B1-CONTRINVUE','B1-CONTRINVNETTO',
                    'B1-ALTRITRACCMMPUB','B1-ALTRITRCCUE','B1-ALTRITRNETTO') AND
      SUBSTR(tipologia_lav,1,1) = v_tit
ORDER BY tipologia_lav, tipo_riga; 

CURSOR sdb_fcdde_totfin IS
SELECT tipologia_lav tip,
       LTRIM(TO_CHAR(NVL(accantonamento_effettivo,0),'9999999990.00')) AccEff,
       REPLACE(denominazione,'TOTALE TITOLO ') titolo,
       LTRIM(TO_CHAR(NVL(stanziamenti_bilancio,0),'9999999990.00')) Stanz,
       LTRIM(TO_CHAR(NVL(accantonamento_obbligatorio,0),'9999999990.00')) AccObbl,
       LTRIM(TO_CHAR(NVL(perc_stanziam_accantonam,0),'990.00')) PercStanzAcc,
       LTRIM(TO_CHAR(NVL(stanziamenti_bilancio1,0),'9999999990.00')) Stanz1,
       LTRIM(TO_CHAR(NVL(accantonamento_obbligatorio1,0),'9999999990.00')) AccObbl1,
       LTRIM(TO_CHAR(NVL(accantonamento_effettivo1,0),'9999999990.00')) AccEff1,
       LTRIM(TO_CHAR(NVL(perc_stanziam_accantonam1,0),'990.00')) PercStanzAcc1,
       LTRIM(TO_CHAR(NVL(stanziamenti_bilancio2,0),'9999999990.00')) Stanz2,
       LTRIM(TO_CHAR(NVL(accantonamento_obbligatorio2,0),'9999999990.00')) AccObbl2,
       LTRIM(TO_CHAR(NVL(accantonamento_effettivo2,0),'9999999990.00')) AccEff2,
       LTRIM(TO_CHAR(NVL(perc_stanziam_accantonam2,0),'990.00')) PercStanzAcc2,
       tipo_riga
FROM fin_t_previsione_fcdde
WHERE anno = p_anno AND
      tipo_bilancio = 'E' AND
      tipo_riga IN ('Q-TOTGEN','R-DICUIPARTECORR','S-DICUICONTOCAP') 
ORDER BY num_riga; 

-- Limite di Indebitamento

-- ATTENZIONE, LA CONDIZIONE SU TIPO_RIGA DEVE INCLUDERE SOLO VALORI POI TRATTATI NELL'IF
CURSOR sdb_ldreg IS
SELECT tipo_riga,
       LTRIM(TO_CHAR(NVL(STANZIAMENTI_BILANCIO,0),'9999999990.00')) stabil,
       LTRIM(TO_CHAR(NVL(STANZIAMENTI_BILANCIO1,0),'9999999990.00')) stabil1,
       LTRIM(TO_CHAR(NVL(STANZIAMENTI_BILANCIO2,0),'9999999990.00')) stabil2
FROM fin_t_previsione_ldr
WHERE anno = p_anno AND
      tipo_bilancio = 'E'  AND
      tipo_riga IN ('I)','DEBAUTOR1','DEBAUTOR2','DEBCONTR','TOTDEBREG','M)','A)','C)',
                    'GARANZIECONC','GARANZIE','DICUIGARANZ','D)','L)','H)','G)','F)','E)','B)');

-- Vincoli Debito di Finanza Pubblica
CURSOR sdb_eqvfp_tit IS
 SELECT '&lt;sp:EQVFP_EntTitolo'||DECODE(SUBSTR(descrizione,1,2),'B)','1','C)','2','D)','3','E)','4','F)','5')||' decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||LTRIM(TO_CHAR(NVL(STANZIAMENTI_BILANCIO,0),'9999999990.00'))||'&lt;/sp:EQVFP_EntTitolo'||DECODE(SUBSTR(descrizione,1,2),'B)','1','C)','2','D)','3','E)','4','F)','5')||'>' r_anno,
        '&lt;sp:EQVFP_EntTitolo'||DECODE(SUBSTR(descrizione,1,2),'B)','1','C)','2','D)','3','E)','4','F)','5')||' decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||LTRIM(TO_CHAR(NVL(STANZIAMENTI_BILANCIO1,0),'9999999990.00'))||'&lt;/sp:EQVFP_EntTitolo'||DECODE(SUBSTR(descrizione,1,2),'B)','1','C)','2','D)','3','E)','4','F)','5')||'>' r_anno1,
        '&lt;sp:EQVFP_EntTitolo'||DECODE(SUBSTR(descrizione,1,2),'B)','1','C)','2','D)','3','E)','4','F)','5')||' decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||LTRIM(TO_CHAR(NVL(STANZIAMENTI_BILANCIO2,0),'9999999990.00'))||'&lt;/sp:EQVFP_EntTitolo'||DECODE(SUBSTR(descrizione,1,2),'B)','1','C)','2','D)','3','E)','4','F)','5')||'>' r_anno2
INTO v_contenuto,
      v_contenuto1,
      v_contenuto2
 FROM fin_t_previsione_efp
 WHERE anno = p_anno AND
       tipo_bilancio = 'E'  AND
       tipo_riga = 'TITOLI';

-- ATTENZIONE, LA CONDIZIONE SU TIPO_RIGA DEVE INCLUDERE SOLO VALORI POI TRATTATI NELL'IF
CURSOR sdb_eqvfp_dett IS
SELECT tipo_riga,
       LTRIM(TO_CHAR(NVL(STANZIAMENTI_BILANCIO,0),'9999999990.00')) stabil,
       LTRIM(TO_CHAR(NVL(STANZIAMENTI_BILANCIO1,0),'9999999990.00')) stabil1,
       LTRIM(TO_CHAR(NVL(STANZIAMENTI_BILANCIO2,0),'9999999990.00')) stabil2
FROM fin_t_previsione_efp
WHERE anno = p_anno AND
      tipo_bilancio = 'E'  AND
      -- tipo_riga IN ('A1','A2','G','H1','H2','H3','H4','H5','H','I1','I3','I4','I','L','M','N');
      --tipo_riga IN ('A1','A2','H1','H2','H3','H4','H5','I1','I3','I4','L','N');
     -- tipo_riga IN ('A1','A2','A','H1','H2','H3','H4','H5','H','I1','I2','I3','I4','I','L1','L','N');--aggiornamento Gerry 22-03-2019
     tipo_riga IN ('A1','A2','A3','A','G','H1','H2','H3','H4','H5','H','I1','I2','I3','I4','I','L1','L','N'); --aggiornamento G.ZACCARO 25.03.2020
-- **** SFine ezione CURSORI per FCDDE, VINCOLI FINANZA PUBBLICA E LIMITI DI INDEBITAMENTO

-- ************ CURSORI per Indicatori Bilancio Prev *******************

cursor ind_sintetici1 is -- Indicatori Sintetici p_anno
select 
decode (tag_sint_tot,null,null,     '  &lt;ip:'||tag_sint_tot||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +0)||'" unitRef="'||unitref||'">'||ltrim(decode(UNITREF,'pure',to_char(nvl(TOT_MISSIONI1,0)/100,'9999999990.0000'),to_char(nvl(TOT_MISSIONI1,0),'9999999990.00')))||'&lt;/ip:'||tag_sint_tot||'>')           is_tot_miss1
,decode (tag_sint_mis13,null,null,   '  &lt;ip:'||tag_sint_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +0)||'" unitRef="'||unitref||'">'||ltrim(decode(UNITREF,'pure',to_char(nvl(MISSIONE13_1,0)/100,'9999999990.0000'),to_char(nvl(MISSIONE13_1,0),'9999999990.00')))||'&lt;/ip:'||tag_sint_mis13||'>')       is_miss13_1
and utente = p_utente
,decode (tag_sint_no_mis13,null,null,'  &lt;ip:'||tag_sint_no_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +0)||'" unitRef="'||unitref||'">'||ltrim(decode(UNITREF,'pure',to_char(nvl(NETTO_MISSIONI1,0)/100,'9999999990.0000'),to_char(nvl(NETTO_MISSIONI1,0),'9999999990.00')))||'&lt;/ip:'||TAG_SINT_NO_MIS13||'>') is_no_miss13_1
from fin_t_indicatori_bilancio
where anno = p_anno
and nvl(tipo_bilancio,'X') = 'P'
and nvl(tipo_indicatore,'X') = 'S'
and definizione is not null;
/*select G.ZACCARO 01/04/2020 PER PRENDERE I DATI CON EUR CON SOLO DUE CIFRE DECIMALI
decode (tag_sint_tot,null,null,     '  &lt;ip:'||tag_sint_tot||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +0)||'" unitRef="'||unitref||'">'||ltrim(to_char(decode(UNITREF,'pure',nvl(TOT_MISSIONI1,0)/100,nvl(TOT_MISSIONI1,0)),'9999999990.0000'))||'&lt;/ip:'||tag_sint_tot||'>')           is_tot_miss1
,decode (tag_sint_mis13,null,null,   '  &lt;ip:'||tag_sint_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +0)||'" unitRef="'||unitref||'">'||ltrim(to_char(decode(UNITREF,'pure',nvl(MISSIONE13_1,0)/100,nvl(MISSIONE13_1,0)),'9999999990.0000'))||'&lt;/ip:'||tag_sint_mis13||'>')       is_miss13_1
,decode (tag_sint_no_mis13,null,null,'  &lt;ip:'||tag_sint_no_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +0)||'" unitRef="'||unitref||'">'||ltrim(to_char(decode(UNITREF,'pure',nvl(NETTO_MISSIONI1,0)/100,nvl(NETTO_MISSIONI1,0)),'9999999990.0000'))||'&lt;/ip:'||TAG_SINT_NO_MIS13||'>') is_no_miss13_1
from fin_t_indicatori_bilancio
where anno = p_anno
and utente = p_utente
and nvl(tipo_bilancio,'X') = 'P'
and nvl(tipo_indicatore,'X') = 'S'
and definizione is not null
order by ord;*/

cursor ind_sintetici2 is  -- Indicatori Sintetici p_anno + 1
select 
decode (tag_sint_tot,null,null,     '  &lt;ip:'||tag_sint_tot||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +1)||'" unitRef="'||unitref||'">'||ltrim(decode(UNITREF,'pure',to_char(nvl(TOT_MISSIONI2,0)/100,'9999999990.0000'),to_char(nvl(TOT_MISSIONI2,0),'9999999990.00')))||'&lt;/ip:'||tag_sint_tot||'>')           is_tot_miss2
,decode (tag_sint_mis13,null,null,   '  &lt;ip:'||tag_sint_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +1)||'" unitRef="'||unitref||'">'||ltrim(decode(UNITREF,'pure',to_char(nvl(MISSIONE13_2,0)/100,'9999999990.0000'),to_char(nvl(MISSIONE13_2,0),'9999999990.00')))||'&lt;/ip:'||tag_sint_mis13||'>')       is_miss13_2
,decode (tag_sint_no_mis13,null,null,'  &lt;ip:'||tag_sint_no_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +1)||'" unitRef="'||unitref||'">'||ltrim(decode(UNITREF,'pure',to_char(nvl(NETTO_MISSIONI2,0)/100,'9999999990.0000'),to_char(nvl(NETTO_MISSIONI2,0),'9999999990.00')))||'&lt;/ip:'||TAG_SINT_NO_MIS13||'>') is_no_miss13_2
from fin_t_indicatori_bilancio
where anno = p_anno
and utente = p_utente
and nvl(tipo_bilancio,'X') = 'P'
and nvl(tipo_indicatore,'X') = 'S'
and definizione is not null
order by ord;

/*select G.ZACCARO 01/04/2020 PER PRENDERE I DATI CON EUR CON SOLO DUE CIFRE DECIMALI
decode (tag_sint_tot,null,null,     '  &lt;ip:'||tag_sint_tot||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +1)||'" unitRef="'||unitref||'">'||ltrim(to_char(decode(UNITREF,'pure',nvl(TOT_MISSIONI2,0)/100,nvl(TOT_MISSIONI2,0)),'9999999990.0000'))||'&lt;/ip:'||tag_sint_tot||'>')           is_tot_miss2
,decode (tag_sint_mis13,null,null,   '  &lt;ip:'||tag_sint_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +1)||'" unitRef="'||unitref||'">'||ltrim(to_char(decode(UNITREF,'pure',nvl(MISSIONE13_2,0)/100,nvl(MISSIONE13_2,0)),'9999999990.0000'))||'&lt;/ip:'||tag_sint_mis13||'>')       is_miss13_2
,decode (tag_sint_no_mis13,null,null,'  &lt;ip:'||tag_sint_no_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +1)||'" unitRef="'||unitref||'">'||ltrim(to_char(decode(UNITREF,'pure',nvl(NETTO_MISSIONI2,0)/100,nvl(NETTO_MISSIONI2,0)),'9999999990.0000'))||'&lt;/ip:'||TAG_SINT_NO_MIS13||'>') is_no_miss13_2
from fin_t_indicatori_bilancio
where anno = p_anno
and utente = p_utente
and nvl(tipo_bilancio,'X') = 'P'
and nvl(tipo_indicatore,'X') = 'S'
and definizione is not null
order by ord;*/

cursor ind_sintetici3 is  -- Indicatori Sintetici p_anno + 2
select 
 decode (tag_sint_tot,null,null,     '  &lt;ip:'||tag_sint_tot||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +2)||'" unitRef="'||unitref||'">'||ltrim(decode(UNITREF,'pure',to_char(nvl(TOT_MISSIONI3,0)/100,'9999999990.0000'),to_char(nvl(TOT_MISSIONI3,0),'9999999990.00')))||'&lt;/ip:'||tag_sint_tot||'>')           is_tot_miss3
,decode (tag_sint_mis13,null,null,   '  &lt;ip:'||tag_sint_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +2)||'" unitRef="'||unitref||'">'||ltrim(decode(UNITREF,'pure',to_char(nvl(MISSIONE13_3,0)/100,'9999999990.0000'),to_char(nvl(MISSIONE13_3,0),'9999999990.00')))||'&lt;/ip:'||tag_sint_mis13||'>')       is_miss13_3
and utente = p_utente
,decode (tag_sint_no_mis13,null,null,'  &lt;ip:'||tag_sint_no_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +2)||'" unitRef="'||unitref||'">'||ltrim(decode(UNITREF,'pure',to_char(nvl(NETTO_MISSIONI3,0)/100,'9999999990.0000'),to_char(nvl(NETTO_MISSIONI3,0),'9999999990.00')))||'&lt;/ip:'||TAG_SINT_NO_MIS13||'>') is_no_miss13_3
from fin_t_indicatori_bilancio
where anno = p_anno
and nvl(tipo_bilancio,'X') = 'P'
and nvl(tipo_indicatore,'X') = 'S'
and definizione is not null
order by ord;

/*select G.ZACCARO 01/04/2020 PER PRENDERE I DATI CON EUR CON SOLO DUE CIFRE DECIMALI
 decode (tag_sint_tot,null,null,     '  &lt;ip:'||tag_sint_tot||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +2)||'" unitRef="'||unitref||'">'||ltrim(to_char(decode(UNITREF,'pure',nvl(TOT_MISSIONI3,0)/100,nvl(TOT_MISSIONI3,0)),'9999999990.0000'))||'&lt;/ip:'||tag_sint_tot||'>')           is_tot_miss3
,decode (tag_sint_mis13,null,null,   '  &lt;ip:'||tag_sint_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +2)||'" unitRef="'||unitref||'">'||ltrim(to_char(decode(UNITREF,'pure',nvl(MISSIONE13_3,0)/100,nvl(MISSIONE13_3,0)),'9999999990.0000'))||'&lt;/ip:'||tag_sint_mis13||'>')       is_miss13_3
,decode (tag_sint_no_mis13,null,null,'  &lt;ip:'||tag_sint_no_mis13||' decimals='||decode(UNITREF,'pure','"4"','"2"')||' contextRef="d_'||(anno +2)||'" unitRef="'||unitref||'">'||ltrim(to_char(decode(UNITREF,'pure',nvl(NETTO_MISSIONI3,0)/100,nvl(NETTO_MISSIONI3,0)),'9999999990.0000'))||'&lt;/ip:'||TAG_SINT_NO_MIS13||'>') is_no_miss13_3
from fin_t_indicatori_bilancio
where anno = p_anno
and utente = p_utente
and nvl(tipo_bilancio,'X') = 'P'
and nvl(tipo_indicatore,'X') = 'S'
and definizione is not null
order by ord;*/


cursor ind_entrata is  -- Indicatori Analitici Entrate
select 
 '  &lt;ip:IA-ENT_'||DEFINIZIONE||'_CompEnt  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(PREVCOMPE_SU_TOT1,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-ENT_'||DEFINIZIONE||'_CompEnt>' CompEnt
,'  &lt;ip:IA-ENT_'||DEFINIZIONE||'_CompEntMediaAcc  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(MACC_SU_MTOT,0)/100,'9999999990.0000'))  ||'&lt;/ip:IA-ENT_'||DEFINIZIONE||'_CompEntMediaAcc>' CompeEntMediaAcc
,'  &lt;ip:IA-ENT_'||DEFINIZIONE||'_Risc         decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(PREVCASSA_SU_TOT1,0)/100,'9999999990.0000'))  ||'&lt;/ip:IA-ENT_'||DEFINIZIONE||'_Risc>' Risc
,'  &lt;ip:IA-ENT_'||DEFINIZIONE||'_RiscMedia     decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(MRISC_SU_MACC,0)/100,'9999999990.0000'))    ||'&lt;/ip:IA-ENT_'||DEFINIZIONE||'_RiscMedia>' RiscMedia
,'  &lt;ip:IA-ENT_'||DEFINIZIONE||'_CompEnt  decimals="4" contextRef="d_'||(anno + 1)||'" unitRef="pure">'||ltrim(to_char(nvl(PREVCOMPE_SU_TOT2,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-ENT_'||DEFINIZIONE||'_CompEnt>' CompEnt2
,'  &lt;ip:IA-ENT_'||DEFINIZIONE||'_CompEnt  decimals="4" contextRef="d_'||(anno + 2)||'" unitRef="pure">'||ltrim(to_char(nvl(PREVCOMPE_SU_TOT3,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-ENT_'||DEFINIZIONE||'_CompEnt>' CompEnt3
from fin_t_indicatori_bilancio 
where anno = p_anno
and utente = p_utente
and nvl(tipo_bilancio,'X') = 'P'
and nvl(tipo_indicatore,'X') = 'E'
and definizione is not null
order by ord;

cursor ind_spese is -- Indicatori Analitici Spese
select
 '  &lt;ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProg  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_MIS_PROG1,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProg>' CompSpeMissProg
,'  &lt;ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProg  decimals="4" contextRef="d_'||(anno + 1)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_MIS_PROG2,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProg>' CompSpeMissProg2
,'  &lt;ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProg  decimals="4" contextRef="d_'||(anno + 2)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_MIS_PROG3,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProg>' CompSpeMissProg3
,'  &lt;ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProgFPV  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_FPV1,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProgFPV>' CompSpeMissProgFPV
,'  &lt;ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProgFPV  decimals="4" contextRef="d_'||(anno + 1)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_FPV2,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProgFPV>' CompSpeMissProgFPV2
,'  &lt;ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProgFPV  decimals="4" contextRef="d_'||(anno + 2)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_FPV3,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProgFPV>' CompSpeMissProgFPV3
,'  &lt;ip:IA-SPE_Prog'||DEFINIZIONE||'_CapPag  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(Cap_Pag1,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_Prog'||DEFINIZIONE||'_CapPag>' CapPag
,'  &lt;ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProgMedia  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_MIS_PROG_MEDIA,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProgMedia>' CompSpeMissProgMedia
where anno = p_anno
,'  &lt;ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProgFPVMedia  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_FPV_MEDIA,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_Prog'||DEFINIZIONE||'_CompSpeMissProgFPVMedia>' CompSpeMissProgFPVMedia
,'  &lt;ip:IA-SPE_Prog'||DEFINIZIONE||'_CapPagMedia  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(Cap_Pag_Media,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_Prog'||DEFINIZIONE||'_CapPagMedia>' CapPagMedia
from fin_t_indicatori_bilancio 
and utente = p_utente
and nvl(tipo_bilancio,'X') = 'P'
and nvl(tipo_indicatore,'X') = 'U'
and definizione is not null
and codice_indicatore2 is not null
order by ord;

cursor ind_spese_missioni is -- Indicatori Analitici Spese
select
 '  &lt;ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProg  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_MIS_PROG1,0)/100,'9999999990.0000'))               ||'&lt;/ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProg>' CompSpeMissProg
,'  &lt;ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProg  decimals="4" contextRef="d_'||(anno + 1)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_MIS_PROG2,0)/100,'9999999990.0000'))               ||'&lt;/ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProg>' CompSpeMissProg2
,'  &lt;ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProg  decimals="4" contextRef="d_'||(anno + 2)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_MIS_PROG3,0)/100,'9999999990.0000'))               ||'&lt;/ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProg>' CompSpeMissProg3
,'  &lt;ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProgFPV  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_FPV1,0)/100,'9999999990.0000'))                    ||'&lt;/ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProgFPV>' CompSpeMissProgFPV
,'  &lt;ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProgFPV  decimals="4" contextRef="d_'||(anno + 1)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_FPV2,0)/100,'9999999990.0000'))                    ||'&lt;/ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProgFPV>' CompSpeMissProgFPV2
,'  &lt;ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProgFPV  decimals="4" contextRef="d_'||(anno + 2)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_FPV3,0)/100,'9999999990.0000'))                    ||'&lt;/ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProgFPV>' CompSpeMissProgFPV3
,'  &lt;ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CapPag  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(Cap_Pag1,0)/100,'9999999990.0000'))                               ||'&lt;/ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CapPag>' CapPag
,'  &lt;ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProgMedia  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_MIS_PROG_MEDIA,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProgMedia>' CompSpeMissProgMedia
,'  &lt;ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProgFPVMedia  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(INC_FPV_MEDIA,0)/100,'9999999990.0000'))       ||'&lt;/ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CompSpeMissProgFPVMedia>' CompSpeMissProgFPVMedia
,'  &lt;ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CapPagMedia  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(Cap_Pag_Media,0)/100,'9999999990.0000'))                    ||'&lt;/ip:IA-SPE_TotMiss'||DEFINIZIONE||'_CapPagMedia>' CapPagMedia
from fin_t_indicatori_bilancio 
where anno = p_anno
and utente = p_utente
and nvl(tipo_bilancio,'X') = 'P'
and nvl(tipo_indicatore,'X') = 'U'
and definizione is not null
and codice_indicatore2 is null
order by ord;

-- ******* FINE  Cursori Indicatori Bilancio Prev


begin

delete fin_t_bdap where utente=p_utente and anno = p_anno;

-- DBCA
-- parte comune
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',010,'&lt;?xml version="1.0" encoding="UTF-8"?>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',020,'&lt;xbrli:xbrl xmlns:dp="http://www.rgs.mef.gov.it/xbrl/bdap/dca/prev/2016-08-26" xmlns:link="http://www.xbrl.org/2003/linkbase" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:iso4217="http://www.xbrl.org/2003/iso4217" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xbrli="http://www.xbrl.org/2003/instance">');

insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',030,'  ');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',040,'  &lt;!--RIFERIMENTO ALLA TASSONOMIA (entry point) -->');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',050,'  &lt;link:schemaRef xlink:type="simple" xlink:href="bdap-dca-prev_2016-08-26.xsd"/>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',060,'  ');

-- CONTESTI 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',090,'  &lt;!-- CONTESTI -->');

-- anno_prec 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',100,'  &lt;xbrli:context id="d_'||(p_anno - 1)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',110,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',150,'      &lt;xbrli:startDate>'||(p_anno - 1)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',120,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',130,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',140,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',160,'      &lt;xbrli:endDate>'||(p_anno - 1)||'-12-31&lt;/xbrli:endDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',170,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',180,'  &lt;/xbrli:context>');

-- anno_0 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',190,'  &lt;xbrli:context id="d_'||(p_anno)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',200,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',210,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',220,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',230,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',240,'      &lt;xbrli:startDate>'||(p_anno)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',250,'      &lt;xbrli:endDate>'||(p_anno)||'-12-31&lt;/xbrli:endDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',260,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',270,'  &lt;/xbrli:context>');

-- anno_1 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',280,'  &lt;xbrli:context id="d_'||(p_anno +1)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',290,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',300,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',310,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',320,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',330,'      &lt;xbrli:startDate>'||(p_anno+1)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',340,'      &lt;xbrli:endDate>'||(p_anno+1)||'-12-31&lt;/xbrli:endDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',350,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',360,'  &lt;/xbrli:context>');

-- anno_2 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',370,'  &lt;xbrli:context id="d_'||(p_anno +2)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',380,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',390,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',400,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',410,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',420,'      &lt;xbrli:startDate>'||(p_anno+2)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',430,'      &lt;xbrli:endDate>'||(p_anno+2)||'-12-31&lt;/xbrli:endDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',440,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',450,'  &lt;/xbrli:context>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',460,'  ');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',470,'  &lt;!-- UNITA'' DI MISURA -->');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',480,'  &lt;xbrli:unit id="eur">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',490,'    &lt;xbrli:measure>iso4217:EUR&lt;/xbrli:measure>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',500,'  &lt;/xbrli:unit>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',510,'  ');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',520,'  &lt;!-- FATTI DA RIPORTARE - INIZIO -->');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',530,'  ');

c_riga := 600;

for c in bdca_e loop

  c_riga:= c_riga+1;
  insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','E',c_riga,'  &lt;!-- DCA Entrate, valorizzazione per la voce "'||c.pcf1||'" (IV livello) del PDCI per 3 anni di previsione-->');

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  ,'PREVDCA'
  (p_utente
  ,sysdate
  ,p_anno
  ,'E'
  ,c_riga
  ,'  &lt;dp:DCAEnt>');
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'E'
  ,c_riga
  ,c.pcf);
  commit;

   c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'E'
  ,c_riga
  ,c.rs_prec);
  commit;

   c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'E'
  ,c_riga
  ,c.cp_prec);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'E'
  ,c_riga
  ,c.cp_anno0);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'E'
  ,c_riga
  ,c.cp_anno1);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'E'
  ,c_riga
  ,c.cp_anno2);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'E'
  ,c_riga
  ,c.cs_prec);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'E'
  ,c_riga
  ,c.cs_anno0);
  commit;

  c_riga:= c_riga+1;
  insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','E',c_riga,'  &lt;/dp:DCAEnt>');
  c_riga:= c_riga+1;
  insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','E',c_riga,'  ');

  commit;

 end loop;

-- uscite

for c in bdca_u loop

  c_riga:= c_riga+1;
  insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','U',c_riga,'  &lt;!-- DCA Uscite, valorizzazione per la voce "'||c.pcf1||'" (IV livello) del PDCI - Missione/Programma "'||c.miss1||'.'||c.prog1||'" per 3 anni di previsione-->');

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,'  &lt;dp:DCAUsc>');
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.pcf);
  commit;

  insert into fin_t_bdap

  c_riga:= c_riga+1;

  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.miss);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.prog);
  commit;


   c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.rs_prec);
  commit;

   c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.cp_prec);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.cp_anno0);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.cp_anno1);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.cp_anno2);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.dicui_imp_anno_prec);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.dicui_imp_anno0);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.dicui_imp_anno1);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.dicui_imp_anno2);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'

  ,c_riga
  ,c.dicui_fpv_anno_prec);
  commit;
  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.dicui_fpv_anno0);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.dicui_fpv_anno1);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.dicui_fpv_anno2);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.cs_prec);
  commit;

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVDCA'
  ,'U'
  ,c_riga
  ,c.cs_anno0);
  commit;

  c_riga:= c_riga+1;
  insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','U',c_riga,'  &lt;/dp:DCAUsc>');
  c_riga:= c_riga+1;
  insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','U',c_riga,'  ');

  commit;

 end loop;

-- fine uscite

  c_riga:= c_riga+1;
  insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',c_riga,'  &lt;!-- FATTI DA RIPORTARE - FINE -->');
  c_riga:= c_riga+1;
  insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','U',c_riga,'  ');
  c_riga:= c_riga+1;
  insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVDCA','T',c_riga,'&lt;/xbrli:xbrl>');
  commit;


-- SDB
-- parte comune

insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',010,'&lt;?xml version="1.0" encoding="UTF-8"?>');
if p_id_ente='899342930540086001'
   then 
-- 2017   insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',020,'&lt;xbrli:xbrl xmlns:spe="http://www.rgs.mef.gov.it/xbrl/bdap/sdb/prev/regioni/2016-10-18" xmlns:link="http://www.xbrl.org/2003/linkbase" xmlns:sp="http://www.rgs.mef.gov.it/xbrl/bdap/sdb/prev/2016-10-18" xmlns:num="http://www.xbrl.org/drt/type/numeric" xmlns:iso4217="http://www.xbrl.org/2003/iso4217" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xbrli="http://www.xbrl.org/2003/instance" xmlns:xlink="http://www.w3.org/1999/xlink">');
   insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',020,'&lt;xbrli:xbrl xmlns:spe="http://www.rgs.mef.gov.it/xbrl/bdap/sdb/prev/regioni/2019-09-23" xmlns:link="http://www.xbrl.org/2003/linkbase" xmlns:sp="http://www.rgs.mef.gov.it/xbrl/bdap/sdb/prev/2019-09-23" xmlns:num="http://www.xbrl.org/drt/type/numeric" xmlns:iso4217="http://www.xbrl.org/2003/iso4217" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xbrli="http://www.xbrl.org/2003/instance" xmlns:xlink="http://www.w3.org/1999/xlink">');
   else 
--2017   insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',020,'&lt;xbrli:xbrl xmlns:spe="http://www.rgs.mef.gov.it/xbrl/bdap/sdb/prev/regioni/2016-10-18" xmlns:link="http://www.xbrl.org/2003/linkbase" xmlns:sp="http://www.rgs.mef.gov.it/xbrl/bdap/sdb/prev/2016-10-18" xmlns:num="http://www.xbrl.org/drt/type/numeric" xmlns:iso4217="http://www.xbrl.org/2003/iso4217" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xbrli="http://www.xbrl.org/2003/instance" xmlns:xlink="http://www.w3.org/1999/xlink">');
   insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',020,'&lt;xbrli:xbrl xmlns:spe="http://www.rgs.mef.gov.it/xbrl/bdap/sdb/prev/regioni/2019-09-23" xmlns:link="http://www.xbrl.org/2003/linkbase" xmlns:sp="http://www.rgs.mef.gov.it/xbrl/bdap/sdb/prev/2019-09-23" xmlns:num="http://www.xbrl.org/drt/type/numeric" xmlns:iso4217="http://www.xbrl.org/2003/iso4217" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xbrli="http://www.xbrl.org/2003/instance" xmlns:xlink="http://www.w3.org/1999/xlink">');
end if;

insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',030,'  ');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',050,'  &lt;link:schemaRef xlink:type="simple" xlink:href="bdap-sdb-prev-regioni_2019-09-23.xsd"/>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',040,'  &lt;!--RIFERIMENTO ALLA TASSONOMIA (entry point) -->');

--insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',050,'  &lt;link:schemaRef xlink:type="simple" xlink:href="bdap-sdb-prev-regioni_2016-10-18.xsd"/>');
--insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',050,'  &lt;link:schemaRef xlink:type="simple" xlink:href="bdap-sdb-prev-regioni_2016-10-18.xsd"/>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',050,'  &lt;link:schemaRef xlink:type="simple" xlink:href="bdap-sdb-prev-regioni_2019-09-23.xsd"/>');

insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',060,'  ');

-- CONTESTI 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',090,'  &lt;!-- CONTESTI -->');

-- anno_prec 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',100,'  &lt;xbrli:context id="d_'||(p_anno - 1)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',110,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',120,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',130,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',140,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',150,'      &lt;xbrli:startDate>'||(p_anno - 1)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',160,'      &lt;xbrli:endDate>'||(p_anno - 1)||'-12-31&lt;/xbrli:endDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',170,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',180,'  &lt;/xbrli:context>');

-- anno_0 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',190,'  &lt;xbrli:context id="d_'||(p_anno)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',200,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',210,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',220,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',230,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',240,'      &lt;xbrli:startDate>'||(p_anno)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',250,'      &lt;xbrli:endDate>'||(p_anno)||'-12-31&lt;/xbrli:endDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',260,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',270,'  &lt;/xbrli:context>');

-- anno_1 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',280,'  &lt;xbrli:context id="d_'||(p_anno +1)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',290,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',300,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',310,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',320,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',330,'      &lt;xbrli:startDate>'||(p_anno+1)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',340,'      &lt;xbrli:endDate>'||(p_anno+1)||'-12-31&lt;/xbrli:endDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',350,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',360,'  &lt;/xbrli:context>');

-- anno_2 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',370,'  &lt;xbrli:context id="d_'||(p_anno +2)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',380,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',390,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',400,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',410,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',420,'      &lt;xbrli:startDate>'||(p_anno+2)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',430,'      &lt;xbrli:endDate>'||(p_anno+2)||'-12-31&lt;/xbrli:endDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',440,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',450,'  &lt;/xbrli:context>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',460,'  ');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',470,'  &lt;!-- UNITA'' DI MISURA -->');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',510,'  &lt;xbrli:unit id="pure">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',480,'  &lt;xbrli:unit id="eur">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',490,'    &lt;xbrli:measure>iso4217:EUR&lt;/xbrli:measure>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',500,'  &lt;/xbrli:unit>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',520,'    &lt;xbrli:measure>xbrli:pure&lt;/xbrli:measure>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',530,'  &lt;/xbrli:unit>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',540,'  ');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',550,'  &lt;!-- FATTI DA RIPORTARE - INIZIO -->');

c_riga := 600;

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Entrate -->');

for e in sdb_e_testata loop

  suffisso := null;

  c_riga:= c_riga+1;

  if e.riga=1
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_FondoPluriennaleVincolatoSpeseCorrenti_CP decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:ENT_FondoPluriennaleVincolatoSpeseCorrenti_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_FondoPluriennaleVincolatoSpeseCorrenti_CP decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:ENT_FondoPluriennaleVincolatoSpeseCorrenti_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_FondoPluriennaleVincolatoSpeseCorrenti_CP decimals="0" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO1,0),'999999999990.00'))||'&lt;/sp:ENT_FondoPluriennaleVincolatoSpeseCorrenti_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_FondoPluriennaleVincolatoSpeseCorrenti_CP decimals="0" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO2,0),'999999999990.00'))||'&lt;/sp:ENT_FondoPluriennaleVincolatoSpeseCorrenti_CP>'
     );
    commit;
  end if;

  if e.riga=2
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_FondoPluriennaleVincolatoSpeseContoCapitale_CP decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:ENT_FondoPluriennaleVincolatoSpeseContoCapitale_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_FondoPluriennaleVincolatoSpeseContoCapitale_CP decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:ENT_FondoPluriennaleVincolatoSpeseContoCapitale_CP>'
     );
     (utente

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_FondoPluriennaleVincolatoSpeseContoCapitale_CP decimals="0" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO1,0),'999999999990.00'))||'&lt;/sp:ENT_FondoPluriennaleVincolatoSpeseContoCapitale_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_FondoPluriennaleVincolatoSpeseContoCapitale_CP decimals="0" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO2,0),'999999999990.00'))||'&lt;/sp:ENT_FondoPluriennaleVincolatoSpeseContoCapitale_CP>'
     );
    commit;
  end if;

  if e.riga=3
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_UtilizzoAvanzoAmministrazione_CP decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:ENT_UtilizzoAvanzoAmministrazione_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_UtilizzoAvanzoAmministrazione_CP decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:ENT_UtilizzoAvanzoAmministrazione_CP>'
     );

    commit;
  end if;


  if e.riga=4
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_UtilizzoAvanzoAmministrazioneUtilizzatoAnticipatamente_CP decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:ENT_UtilizzoAvanzoAmministrazioneUtilizzatoAnticipatamente_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_UtilizzoAvanzoAmministrazioneUtilizzatoAnticipatamente_CP decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:ENT_UtilizzoAvanzoAmministrazioneUtilizzatoAnticipatamente_CP>'
     );

    commit;
  end if;

  if e.riga=6
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT_FondoCassaInizioEsercizio_CS decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.CASSA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:ENT_FondoCassaInizioEsercizio_CS>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
    commit;
     ,'  &lt;sp:ENT_FondoCassaInizioEsercizio_CS decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.CASSA_ANNO0,0),'999999999990.00'))||'&lt;/sp:ENT_FondoCassaInizioEsercizio_CS>'
     );

  end if;

 end loop; -- testata SDB 1

 for e in sdb_e_2 loop

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.rs_prec
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cp_prec
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cp_anno0
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cp_anno1
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cp_anno2
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cs_prec
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cs_anno0
  );

  parametro_where := e.pcf;

  for d in sdb_e_1_1 loop

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.rs_prec
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cp_prec
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cp_anno0
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,d.cp_anno1
    ,'PREVSDB'
    ,'E'
    ,c_riga
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cp_anno2
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cs_prec
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cs_anno0
    );

    end loop sdb_e_1_1;
    commit;

  for d in sdb_e_1_2 loop

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.rs_prec
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cp_prec
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cp_anno0
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cp_anno1
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cp_anno2
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cs_prec
    );

    c_riga:= c_riga+1;

    insert into fin_t_bdap
    (utente
    ,data_creazione
    ,anno
    ,tipo_trasmissione
    ,eu
    ,riga
    ,contenuto)
    values 
    (p_utente
    ,sysdate
    ,p_anno
    ,'PREVSDB'
    ,'E'
    ,c_riga
    ,d.cs_anno0
    );

    end loop sdb_e_1_2;
    commit;

 end loop sdb_e_2; -- sdb_e_2 singolo titolo entrate
 commit;

 for d in sdb_e_3 loop -- totale titoli

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   ,'PREVSDB'
   (p_utente
   ,sysdate
   ,p_anno
   ,'E'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cs_anno0
   );
 end loop sdb_e_3;
   commit;

 for d in sdb_e_4 loop -- totale generale entrate

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,riga
   ,anno
   ,tipo_trasmissione
   ,eu
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cs_anno0
   );
 end loop sdb_e_4;
 commit;


--totale per titoli

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Riepilogo generale entrate per titoli -->');
 commit;

for e in sdb_e_testata loop

  suffisso := '-TIT';


  c_riga:= c_riga+1;

  if e.riga=1
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_FondoPluriennaleVincolatoSpeseCorrenti_CP decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_FondoPluriennaleVincolatoSpeseCorrenti_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_FondoPluriennaleVincolatoSpeseCorrenti_CP decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_FondoPluriennaleVincolatoSpeseCorrenti_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_FondoPluriennaleVincolatoSpeseCorrenti_CP decimals="0" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO1,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_FondoPluriennaleVincolatoSpeseCorrenti_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_FondoPluriennaleVincolatoSpeseCorrenti_CP decimals="0" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO2,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_FondoPluriennaleVincolatoSpeseCorrenti_CP>'
     );
    commit;
  end if;

  if e.riga=2
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_FondoPluriennaleVincolatoSpeseContoCapitale_CP decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_FondoPluriennaleVincolatoSpeseContoCapitale_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     c_riga:= c_riga+1;
     ,'  &lt;sp:ENT-TIT_FondoPluriennaleVincolatoSpeseContoCapitale_CP decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_FondoPluriennaleVincolatoSpeseContoCapitale_CP>'
     );

     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_FondoPluriennaleVincolatoSpeseContoCapitale_CP decimals="0" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO1,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_FondoPluriennaleVincolatoSpeseContoCapitale_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_FondoPluriennaleVincolatoSpeseContoCapitale_CP decimals="0" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO2,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_FondoPluriennaleVincolatoSpeseContoCapitale_CP>'
     );
    commit;
  end if;

  if e.riga=3
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_UtilizzoAvanzoAmministrazione_CP decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_UtilizzoAvanzoAmministrazione_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_UtilizzoAvanzoAmministrazione_CP decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_UtilizzoAvanzoAmministrazione_CP>'
     );

    commit;
  end if;


  if e.riga=4
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_UtilizzoAvanzoAmministrazioneUtilizzatoAnticipatamente_CP decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_UtilizzoAvanzoAmministrazioneUtilizzatoAnticipatamente_CP>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_UtilizzoAvanzoAmministrazioneUtilizzatoAnticipatamente_CP decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_UtilizzoAvanzoAmministrazioneUtilizzatoAnticipatamente_CP>'
     );

    commit;
  end if;

  if e.riga=6
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_FondoCassaInizioEsercizio_CS decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.CASSA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_FondoCassaInizioEsercizio_CS>'
     );

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,riga
     ,anno
     ,tipo_trasmissione
     ,eu
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'E'
     ,c_riga
     ,'  &lt;sp:ENT-TIT_FondoCassaInizioEsercizio_CS decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.CASSA_ANNO0,0),'999999999990.00'))||'&lt;/sp:ENT-TIT_FondoCassaInizioEsercizio_CS>'
     );

    commit;
  end if;

 end loop sdb_e_testata; -- testata totale titoli

 for e in sdb_e_2 loop

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.rs_prec
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cp_prec
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cp_anno0
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cp_anno1
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cp_anno2
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cs_prec
  );

  c_riga:= c_riga+1;

  insert into fin_t_bdap
  (utente
  ,data_creazione
  ,anno
  ,tipo_trasmissione
  ,eu
  ,riga
  ,contenuto)
  values 
  (p_utente
  ,sysdate
  ,p_anno
  ,'PREVSDB'
  ,'E'
  ,c_riga
  ,e.cs_anno0
  );
 end loop  sdb_e_2;
 commit;

 for d in sdb_e_3 loop -- totale titoli

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   ,tipo_trasmissione
   (utente
   ,data_creazione
   ,anno
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cs_anno0
   );
 end loop sdb_e_3;
   commit;

 for d in sdb_e_4 loop -- totale generale entrate

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'E'
   ,c_riga
   ,d.cs_anno0
   );
 end loop sdb_e_4;
 commit;

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 for e in sdb_u_testata loop -- disavanzo e disavanzo autorizzato 21.11.2019
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Spese -->');



  suffisso := null;
  c_riga:= c_riga+1;


  if e.riga=1
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:SPE_DisavanzoAmministrazione>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:SPE_DisavanzoAmministrazione>'
     );

    commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO1,0),'999999999990.00'))||'&lt;/sp:SPE_DisavanzoAmministrazione>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO2,0),'999999999990.00'))||'&lt;/sp:SPE_DisavanzoAmministrazione>'
     );

    commit;

  end if;

    c_riga:= c_riga+1;


  if e.riga=2
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:SPE_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:SPE_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

    commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO1,0),'999999999990.00'))||'&lt;/sp:SPE_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     ,tipo_trasmissione
     (utente
     ,data_creazione
     ,anno
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO2,0),'999999999990.00'))||'&lt;/sp:SPE_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

    commit;

  end if;

 end loop sdb_u_testata; -- testata spese (disavanzo)

 for d in sdb_u_1 loop -- missioni/programmi/pcf

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );
   insert into fin_t_bdap

   c_riga:= c_riga+1;

   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;

 end loop sdb_u_1;

 for d in sdb_u_2 loop -- missioni/programmi

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,d.dicui_imp_anno2
   ,'PREVSDB'
   ,'U'
   ,c_riga
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;

 end loop sdb_u_2;

 for d in sdb_u_3 loop -- missioni

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   (utente
   c_riga:= c_riga+1;

   insert into fin_t_bdap
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;

 end loop sdb_u_3;

 suffisso := '_TotaleMissioni';

 for d in sdb_u_4 loop -- Totale Missioni (escluso disavanzo)

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,eu
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;

 end loop sdb_u_4;

 suffisso := null;



 for d in sdb_u_5 loop -- Totale Generale (incluso disavanzo)

   c_riga:= c_riga+1;
   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'

   ,c_riga
   ,d.dicui_fpv_anno2
   );
   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;

 end loop sdb_u_5;

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Riepilogo generale delle spese per titoli -->');

 for e in sdb_u_testata loop -- disavanzo e disavanzo autorizzato 21.11.2019

  suffisso := null;
  c_riga:= c_riga+1;


  if e.riga=1
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-TIT_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:SPE-TIT_DisavanzoAmministrazione>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-TIT_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:SPE-TIT_DisavanzoAmministrazione>'
     );

    commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-TIT_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO1,0),'999999999990.00'))||'&lt;/sp:SPE-TIT_DisavanzoAmministrazione>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-TIT_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO2,0),'999999999990.00'))||'&lt;/sp:SPE-TIT_DisavanzoAmministrazione>'
     );

    commit;

  end if;



  c_riga:= c_riga+1;


  if e.riga=2
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-TIT_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:SPE-TIT_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     (p_utente
     ,riga
     ,contenuto)
     values 
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-TIT_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:SPE-TIT_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

    commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-TIT_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO1,0),'999999999990.00'))||'&lt;/sp:SPE-TIT_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-TIT_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO2,0),'999999999990.00'))||'&lt;/sp:SPE-TIT_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

    commit;

  end if;

 end loop sdb_u_testata; -- testata spese (disavanzo)


 for d in sdb_u_tit_1 loop -- Titoli (escluso disavanzo)


   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1

   );

   c_riga:= c_riga+1;
   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;

 end loop sdb_u_tit_1;

 suffisso :='-TIT_TotaleTitoli';

 for d in sdb_u_4 loop -- Totale Titoli (escluso disavanzo)

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   ,anno
   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;

 end loop sdb_u_4;

 suffisso := '-TIT';


 for d in sdb_u_5 loop -- Totale Generale (incluso disavanzo)

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,d.cp_prec
   ,'PREVSDB'
   ,'U'
   ,c_riga
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;
 c_riga := c_riga+1;

 end loop sdb_u_5;

 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Riepilogo generale delle spese per missioni -->');

 for e in sdb_u_testata loop -- disavanzo e disavanzo autorizzato 21.11.2019

  suffisso := null;
  c_riga:= c_riga+1;


  if e.riga=1
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-MIS_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:SPE-MIS_DisavanzoAmministrazione>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-MIS_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:SPE-MIS_DisavanzoAmministrazione>'
     );

    commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-MIS_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO1,0),'999999999990.00'))||'&lt;/sp:SPE-MIS_DisavanzoAmministrazione>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-MIS_DisavanzoAmministrazione decimals="0" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO2,0),'999999999990.00'))||'&lt;/sp:SPE-MIS_DisavanzoAmministrazione>'
     );

    commit;

  end if;


 c_riga:= c_riga+1;


  if e.riga=2
     then 
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-MIS_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno - 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO_PREC,0),'999999999990.00'))||'&lt;/sp:SPE-MIS_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-MIS_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno + 0)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO0,0),'999999999990.00'))||'&lt;/sp:SPE-MIS_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

    commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
     ,'  &lt;sp:SPE-MIS_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno + 1)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO1,0),'999999999990.00'))||'&lt;/sp:SPE-MIS_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );

     commit;

     c_riga:= c_riga+1;
     insert into fin_t_bdap
     (utente
     ,data_creazione
     ,anno
     ,tipo_trasmissione
     ,eu
     ,riga
     ,contenuto)
     values 
     (p_utente
     ,sysdate
     ,p_anno
     ,'PREVSDB'
     ,'U'
     ,c_riga
    commit;
     ,'  &lt;sp:SPE-MIS_DisavanzoDerivanteDebitoAutorizzatoNonContratto decimals="0" contextRef="d_'||(p_anno + 2)||'" unitRef="eur">'||ltrim(to_char(nvl(e.COMPETENZA_ANNO2,0),'999999999990.00'))||'&lt;/sp:SPE-MIS_DisavanzoDerivanteDebitoAutorizzatoNonContratto>'
     );


  end if;

 end loop sdb_u_testata; -- testata spese (disavanzo)


 for d in sdb_u_mis_1 loop -- MISSIONI (escluso disavanzo)


   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   (utente
   c_riga:= c_riga+1;

   insert into fin_t_bdap
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;

 end loop sdb_u_tit_1;

 suffisso :='-MIS_TotaleMissioni';

 for d in sdb_u_4 loop -- Totale Titoli (escluso disavanzo)

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno2
   );

   c_riga:= c_riga+1;

   ,anno
   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;

 end loop sdb_u_4;

 suffisso := '-MIS';

 for d in sdb_u_5 loop -- Totale Generale (incluso disavanzo)

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.rs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   values 
   ,eu
   ,riga
   ,contenuto)
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_imp_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.dicui_fpv_anno2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_prec
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.cs_anno0
   );

   commit;

 end loop sdb_u_5;

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Tabella Dimostrativa Risultato Amministrazione Presunto -->');

 for d in sdb_tdrap loop 

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'T'
   ,c_riga
   ,d.tdrap
   );
   commit;

 end loop sdb_tdrap;

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Composizione per missioni e programmi del fondo pluriennale vincolato -->');

for d in sdb_fpv_miss loop -- Fpv Missioni 

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.a0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   values 
   ,eu
   ,riga
   ,contenuto)
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.a1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.a2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.b0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.b1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.b2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.c0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.c1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.c2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.d0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.d1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.d2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.e0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.e1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   ,p_anno
   values 
   (p_utente
   ,sysdate
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.e2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.f0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.f1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.f2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.g0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.g1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.g2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.h0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.h1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.h2
   );

   commit;

end loop sdb_fpv_miss; 

for d in sdb_fpv_prog loop -- Fpv Programmi 

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.a0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.a1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.a2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   values 
   ,eu
   ,riga
   ,contenuto)
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.b0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.b1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.b2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.c0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.c1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.c2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.d0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.d1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.d2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.e0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.e1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,sysdate
   ,contenuto)
   values 
   (p_utente
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.e2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.f0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.f1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.f2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.g0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.g1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.g2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.h0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.h1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.h2
   );

   commit;

end loop sdb_fpv_prog; 


for d in sdb_fpv_tot loop -- Totali Fpv 

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.a0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.a1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.a2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   ,tipo_trasmissione
   (utente
   ,data_creazione
   ,anno
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.b0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.b1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.b2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.c0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.c1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.c2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.d0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.d1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.d2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.e0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.e1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.e2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.f0
   );

   c_riga:= c_riga+1;

   ,anno
   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.f1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.f2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.g0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.g1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.g2
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.h0
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.h1
   );

   c_riga:= c_riga+1;

   insert into fin_t_bdap
   (utente
   ,data_creazione
   ,anno
   ,tipo_trasmissione
   ,eu
   ,riga
   ,contenuto)
   values 
   (p_utente
   ,sysdate
   ,p_anno
   ,'PREVSDB'
   ,'U'
   ,c_riga
   ,d.h2
   );

   commit;

end loop sdb_fpv_tot; 

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Quadro Generale Riassuntivo -->');

for d in sdb_qgr loop

   if d.qgr_e_cassa is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      (p_utente
      ,sysdate
      ,p_anno
      ,'PREVSDB'
      ,'U'
      ,c_riga
      ,d.qgr_e_cassa);
    end if;

   if d.qgr_u_cassa is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      (p_utente
      ,sysdate
      ,p_anno
      ,'PREVSDB'
      ,'U'
      ,c_riga
      ,d.qgr_u_cassa);
    end if;

   if d.qgr_e_anno0 is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      (p_utente
      ,sysdate
      ,p_anno
      ,'PREVSDB'
      ,'U'
      ,c_riga
      ,d.qgr_e_anno0);
    end if;

   if d.qgr_u_anno0 is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      ,'PREVSDB'
      (p_utente
      ,sysdate
      ,p_anno
      ,'U'
      ,c_riga
      ,d.qgr_u_anno0);
    end if;

   if d.qgr_e_anno1 is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      (p_utente
      ,sysdate
      ,p_anno
      ,'PREVSDB'
      ,'U'
      ,c_riga
      ,d.qgr_e_anno1);
    end if;

   if d.qgr_u_anno1 is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      (p_utente
      ,sysdate
      ,p_anno
      ,'PREVSDB'
      ,'U'
      ,c_riga
      ,d.qgr_u_anno1);
    end if;

   if d.qgr_e_anno2 is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      (p_utente
      ,sysdate
      ,p_anno
      ,'PREVSDB'
      ,'U'
      ,c_riga
      ,d.qgr_e_anno2);
    end if;

   if d.qgr_u_anno2 is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      (p_utente
      ,sysdate
      ,p_anno
      ,'PREVSDB'
      ,'U'
      ,c_riga
      ,d.qgr_u_anno2);
    end if;

   commit;

end loop sdb_qgr;


 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Equilibri di Bilancio -->');

for d in sdb_eqb loop

   if d.eqb_anno0 is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      (p_utente
      ,sysdate
      ,p_anno
      ,'PREVSDB'
      ,'U'
      ,c_riga
      ,d.eqb_anno0);
    end if;

   if d.eqb_anno1 is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      (p_utente
      ,sysdate
      ,p_anno
      ,'PREVSDB'
      ,'U'
      ,c_riga
      ,d.eqb_anno1);
    end if;

   if d.eqb_anno2 is not null
      then
      c_riga:= c_riga+1;
      insert into fin_t_bdap
      (utente
      ,data_creazione
      ,anno
      ,tipo_trasmissione
      ,eu
      ,riga
      ,contenuto)
      values 
      (p_utente
      ,sysdate
      ,p_anno
      ,'PREVSDB'
      ,'U'
      ,c_riga
      ,d.eqb_anno2);
    end if;

   commit;

end loop sdb_eqb;


 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Fondo Crediti di Dubbia Esigibilita'' -->');


 FOR r IN sdb_fcdde_tit LOOP

  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccEff decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.AccEff||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccEff>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccObbl decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.AccObbl||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccObbl>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_PercStanzAcc decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.PercStanzAcc||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_PercStanzAcc>'; 
  c_riga := c_riga + 1;
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_Stanz decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.Stanz||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_Stanz>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

  -- anno + 1
  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccEff decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.AccEff1||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccEff>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccObbl decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.AccObbl1||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccObbl>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);
  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_PercStanzAcc decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.PercStanzAcc1||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_PercStanzAcc>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_Stanz decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.Stanz1||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_Stanz>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

  -- anno + 2
  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccEff decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.AccEff2||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccEff>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccObbl decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.AccObbl2||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_AccObbl>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_PercStanzAcc decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.PercStanzAcc2||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_PercStanzAcc>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

  c_riga := c_riga + 1;
  v_contenuto := '&lt;sp:FCDDE_E.'||r.titolo||'.00.00.00.000_Stanz decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.Stanz2||'&lt;/sp:FCDDE_E.'||r.titolo||'.00.00.00.000_Stanz>'; 
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);
  --
  --
  v_tit := r.titolo;
  FOR s IN sdb_fcdde_tip LOOP
   v1 := 'FCDDE_E.'||SUBSTR(s.tip,1,1)||'.'||SUBSTR(s.tip,2,2)||'.'||SUBSTR(s.tip,4,2)||'.'||SUBSTR(s.tip,6,2)||'.000_';
   IF s.tipo_riga = 'B-TIPOLOGIA' THEN v2 := NULL;
    ELSIF s.tipo_riga = 'B1-DICUIACCPERCASSA' THEN v2 := 'AccCassa_';
    ELSIF s.tipo_riga = 'B1-DICUINONACCPERCASSA' THEN v2 := 'NonAccCassa_';
    ELSIF s.tipo_riga = 'B1-TRASFUE' THEN v2 := 'TrasfCorrUE_';
    ELSIF s.tipo_riga = 'B1-TRASFRESTOM' THEN v2 := 'TrasfCorrMondo_';
    ELSIF s.tipo_riga = 'B1-CONTRINVAMMPUB' THEN v2 := 'ContrInvestPA_';
    ELSIF s.tipo_riga = 'B1-CONTRINVUE' THEN v2 := 'ContrInvestUE_';
    ELSIF s.tipo_riga = 'B1-CONTRINVNETTO' THEN v2 := 'ContrInvestNonUE-PA_';
    ELSIF s.tipo_riga = 'B1-ALTRITRACCMMPUB' THEN v2 := 'TrasfPA_';
    ELSIF s.tipo_riga = 'B1-ALTRITRCCUE' THEN v2 := 'TrasfUe_';
    ELSIF s.tipo_riga = 'B1-ALTRITRNETTO' THEN v2 := 'TrasfNonUE-PA_';
   END IF;

   IF s.tipo_riga in ('B-TIPOLOGIA' ,'B1-DICUIACCPERCASSA','B-TIPOLOGIA','B1-DICUIACCPERCASSA','B-TIPOLOGIA','B1-CONTRINVAMMPUB'	
                     ,'B1-CONTRINVUE','B-TIPOLOGIA','B1-ALTRITRACCMMPUB','B1-ALTRITRCCUE','B1-TRASFUE') and s.tip in (1010100,1010200,1010300,2010500,4020000,4030000)
   THEN
   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'Stanz decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||s.Stanz||'&lt;/sp:'||v1||v2||'Stanz>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   ELSE
   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'AccEff decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||s.AccEff||'&lt;/sp:'||v1||v2||'AccEff>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'AccObbl decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||s.AccObbl||'&lt;/sp:'||v1||v2||'AccObbl>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);
   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'PercStanzAcc decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||s.PercStanzAcc||'&lt;/sp:'||v1||v2||'PercStanzAcc>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'Stanz decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||s.Stanz||'&lt;/sp:'||v1||v2||'Stanz>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   END IF;

   -- anno + 1
   IF s.tipo_riga in ('B-TIPOLOGIA' ,'B1-DICUIACCPERCASSA','B-TIPOLOGIA','B1-DICUIACCPERCASSA','B-TIPOLOGIA','B1-CONTRINVAMMPUB'	
                     ,'B1-CONTRINVUE','B-TIPOLOGIA','B1-ALTRITRACCMMPUB','B1-ALTRITRCCUE','B1-TRASFUE') and s.tip in (1010100,1010200,1010300,2010500,4020000,4030000)
   THEN
   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'Stanz decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||s.Stanz1||'&lt;/sp:'||v1||v2||'Stanz>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   ELSE
   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'AccEff decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||s.AccEff1||'&lt;/sp:'||v1||v2||'AccEff>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'AccObbl decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||s.AccObbl1||'&lt;/sp:'||v1||v2||'AccObbl>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'PercStanzAcc decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||s.PercStanzAcc1||'&lt;/sp:'||v1||v2||'PercStanzAcc>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'Stanz decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||s.Stanz1||'&lt;/sp:'||v1||v2||'Stanz>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);
   END IF;

   -- anno + 2
   IF s.tipo_riga in ('B-TIPOLOGIA' ,'B1-DICUIACCPERCASSA','B-TIPOLOGIA','B1-DICUIACCPERCASSA','B-TIPOLOGIA','B1-CONTRINVAMMPUB'	
                     ,'B1-CONTRINVUE','B-TIPOLOGIA','B1-ALTRITRACCMMPUB','B1-ALTRITRCCUE','B1-TRASFUE') and s.tip in (1010100,1010200,1010300,2010500,4020000,4030000)

   THEN
   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'Stanz decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||s.Stanz2||'&lt;/sp:'||v1||v2||'Stanz>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);
   ELSE
   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'AccEff decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||s.AccEff2||'&lt;/sp:'||v1||v2||'AccEff>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'AccObbl decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||s.AccObbl2||'&lt;/sp:'||v1||v2||'AccObbl>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'PercStanzAcc decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||s.PercStanzAcc2||'&lt;/sp:'||v1||v2||'PercStanzAcc>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||v2||'Stanz decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||s.Stanz2||'&lt;/sp:'||v1||v2||'Stanz>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);
   END IF;

  END LOOP; -- sdb_fcdde_tip;
 END LOOP;  -- sdb_fcdde_tit
--
--
 FOR s IN sdb_fcdde_totfin LOOP
   IF s.tipo_riga = 'Q-TOTGEN' THEN v1 := 'FCDDE_TotaleGenerale_';
    ELSIF s.tipo_riga = 'R-DICUIPARTECORR' THEN v1 := 'FCDDE_TotaleGeneraleParteCorrente_';
    ELSIF s.tipo_riga = 'S-DICUICONTOCAP' THEN v1 := 'FCDDE_TotaleGeneraleCCapitale_';
   END IF;

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'AccEff decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||s.AccEff||'&lt;/sp:'||v1||'AccEff>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'AccObbl decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||s.AccObbl||'&lt;/sp:'||v1||'AccObbl>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   v_contenuto := '&lt;sp:'||v1||'PercStanzAcc decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||s.PercStanzAcc||'&lt;/sp:'||v1||'PercStanzAcc>';
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'Stanz decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||s.Stanz||'&lt;/sp:'||v1||'Stanz>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   -- anno + 1
   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'AccEff decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||s.AccEff1||'&lt;/sp:'||v1||'AccEff>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'AccObbl decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||s.AccObbl1||'&lt;/sp:'||v1||'AccObbl>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'PercStanzAcc decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||s.PercStanzAcc1||'&lt;/sp:'||v1||'PercStanzAcc>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'Stanz decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||s.Stanz1||'&lt;/sp:'||v1||'Stanz>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   -- anno + 2
   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'AccEff decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||s.AccEff2||'&lt;/sp:'||v1||'AccEff>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'AccObbl decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||s.AccObbl2||'&lt;/sp:'||v1||'AccObbl>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'PercStanzAcc decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||s.PercStanzAcc2||'&lt;/sp:'||v1||'PercStanzAcc>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);

   c_riga := c_riga + 1;
   v_contenuto := '&lt;sp:'||v1||'Stanz decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||s.Stanz2||'&lt;/sp:'||v1||'Stanz>';
   INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
   VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);
 END LOOP; -- sdb_fcdde_totfin

 COMMIT;

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Prospetto  Dimostrativo Del Rispetto Dei Vincoli Di Indebitamento Delle Regioni E Delle Province Autonome -->');

 FOR r in sdb_ldreg LOOP
  IF r.tipo_riga = 'I)' THEN
    v_contenuto :=  '&lt;sp:LDREG_ContributiErarialiRateAmmortamentoMutui decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_ContributiErarialiRateAmmortamentoMutui>';
    v_contenuto1 := '&lt;sp:LDREG_ContributiErarialiRateAmmortamentoMutui decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_ContributiErarialiRateAmmortamentoMutui>';
    v_contenuto2 := '&lt;sp:LDREG_ContributiErarialiRateAmmortamentoMutui decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_ContributiErarialiRateAmmortamentoMutui>';
  ELSIF r.tipo_riga = 'DEBAUTOR1' THEN
    v_contenuto :=  '&lt;sp:LDREG_DebitoAutorizzatoEsercizio decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_DebitoAutorizzatoEsercizio>';
    v_contenuto1 := '&lt;sp:LDREG_DebitoAutorizzatoEsercizio decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_DebitoAutorizzatoEsercizio>';
    v_contenuto2 := '&lt;sp:LDREG_DebitoAutorizzatoEsercizio decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_DebitoAutorizzatoEsercizio>';
  ELSIF r.tipo_riga = 'DEBAUTOR2' THEN
    v_contenuto :=  '&lt;sp:LDREG_DebitoAutorizzatoLeggeEsame decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_DebitoAutorizzatoLeggeEsame>';
    v_contenuto1 := '&lt;sp:LDREG_DebitoAutorizzatoLeggeEsame decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_DebitoAutorizzatoLeggeEsame>';
    v_contenuto2 := '&lt;sp:LDREG_DebitoAutorizzatoLeggeEsame decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_DebitoAutorizzatoLeggeEsame>';
  ELSIF r.tipo_riga = 'DEBCONTR' THEN
    v_contenuto :=  '&lt;sp:LDREG_DebitoContrattoEsercizioPrec decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_DebitoContrattoEsercizioPrec>';
    v_contenuto1 := '&lt;sp:LDREG_DebitoContrattoEsercizioPrec decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_DebitoContrattoEsercizioPrec>';
    v_contenuto1 := '&lt;sp:LDREG_DebitoTotale decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_DebitoTotale>';
    v_contenuto2 := '&lt;sp:LDREG_DebitoContrattoEsercizioPrec decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_DebitoContrattoEsercizioPrec>';
  ELSIF r.tipo_riga = 'TOTDEBREG' THEN
    v_contenuto :=  '&lt;sp:LDREG_DebitoTotale decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_DebitoTotale>';
    v_contenuto2 := '&lt;sp:LDREG_DebitoTotale decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_DebitoTotale>';
  ELSIF r.tipo_riga = 'M)' THEN
    v_contenuto :=  '&lt;sp:LDREG_DisponibileNuoveRateAmmortamento decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_DisponibileNuoveRateAmmortamento>';
    v_contenuto1 := '&lt;sp:LDREG_DisponibileNuoveRateAmmortamento decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_DisponibileNuoveRateAmmortamento>';
    v_contenuto2 := '&lt;sp:LDREG_DisponibileNuoveRateAmmortamento decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_DisponibileNuoveRateAmmortamento>';
  ELSIF r.tipo_riga = 'A)' THEN
    v_contenuto :=  '&lt;sp:LDREG_EntrateCorrentiNaturaTributariaContributivaPerequativa decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_EntrateCorrentiNaturaTributariaContributivaPerequativa>';
    v_contenuto1 := '&lt;sp:LDREG_EntrateCorrentiNaturaTributariaContributivaPerequativa decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_EntrateCorrentiNaturaTributariaContributivaPerequativa>';
    v_contenuto2 := '&lt;sp:LDREG_EntrateCorrentiNaturaTributariaContributivaPerequativa decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_EntrateCorrentiNaturaTributariaContributivaPerequativa>';
  ELSIF r.tipo_riga = 'C)' THEN
    v_contenuto :=  '&lt;sp:LDREG_EntrateTributarieNettoSanita decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_EntrateTributarieNettoSanita>';
    v_contenuto1 := '&lt;sp:LDREG_EntrateTributarieNettoSanita decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_EntrateTributarieNettoSanita>';
    v_contenuto2 := '&lt;sp:LDREG_EntrateTributarieNettoSanita decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_EntrateTributarieNettoSanita>';
  ELSIF r.tipo_riga = 'GARANZIECONC' THEN
    v_contenuto :=  '&lt;sp:LDREG_GaranzieLimiteIndebitamento decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_GaranzieLimiteIndebitamento>';
    v_contenuto1 := '&lt;sp:LDREG_GaranzieLimiteIndebitamento decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_GaranzieLimiteIndebitamento>';
    v_contenuto2 := '&lt;sp:LDREG_GaranzieLimiteIndebitamento decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_GaranzieLimiteIndebitamento>';
  ELSIF r.tipo_riga = 'GARANZIE' THEN
    v_contenuto :=  '&lt;sp:LDREG_GaranziePrestateAltrePA decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_GaranziePrestateAltrePA>';
    v_contenuto1 := '&lt;sp:LDREG_GaranziePrestateAltrePA decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_GaranziePrestateAltrePA>';
    v_contenuto2 := '&lt;sp:LDREG_GaranziePrestateAltrePA decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_GaranziePrestateAltrePA>';
  ELSIF r.tipo_riga = 'DICUIGARANZ' THEN
    v_contenuto :=  '&lt;sp:LDREG_GaranziePrestateAltrePAAccantonamento decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_GaranziePrestateAltrePAAccantonamento>';
    v_contenuto1 := '&lt;sp:LDREG_GaranziePrestateAltrePAAccantonamento decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_GaranziePrestateAltrePAAccantonamento>';
    v_contenuto2 := '&lt;sp:LDREG_GaranziePrestateAltrePAAccantonamento decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_GaranziePrestateAltrePAAccantonamento>';
  ELSIF r.tipo_riga = 'D)' THEN
    v_contenuto :=  '&lt;sp:LDREG_LivelloMassimoSpesaAnnuale decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_LivelloMassimoSpesaAnnuale>';
    v_contenuto1 := '&lt;sp:LDREG_LivelloMassimoSpesaAnnuale decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_LivelloMassimoSpesaAnnuale>';
    v_contenuto2 := '&lt;sp:LDREG_LivelloMassimoSpesaAnnuale decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_LivelloMassimoSpesaAnnuale>';
  ELSIF r.tipo_riga = 'L)' THEN
    v_contenuto :=  '&lt;sp:LDREG_RateDebitiEsclusiLimitiIndebitamento decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_RateDebitiEsclusiLimitiIndebitamento>';
    v_contenuto1 := '&lt;sp:LDREG_RateDebitiEsclusiLimitiIndebitamento decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_RateDebitiEsclusiLimitiIndebitamento>';
    v_contenuto2 := '&lt;sp:LDREG_RateDebitiEsclusiLimitiIndebitamento decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_RateDebitiEsclusiLimitiIndebitamento>';
  ELSIF r.tipo_riga = 'H)' THEN
    v_contenuto :=  '&lt;sp:LDREG_RateMutuiPrestitiAutorizzatiLeggeEsame decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_RateMutuiPrestitiAutorizzatiLeggeEsame>';
    v_contenuto1 := '&lt;sp:LDREG_RateMutuiPrestitiAutorizzatiLeggeEsame decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_RateMutuiPrestitiAutorizzatiLeggeEsame>';
    v_contenuto2 := '&lt;sp:LDREG_RateMutuiPrestitiAutorizzatiLeggeEsame decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_RateMutuiPrestitiAutorizzatiLeggeEsame>';
  ELSIF r.tipo_riga = 'G)' THEN
    v_contenuto :=  '&lt;sp:LDREG_RateMutuiPrestitiDebitoPotenziale decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_RateMutuiPrestitiDebitoPotenziale>';
    v_contenuto1 := '&lt;sp:LDREG_RateMutuiPrestitiDebitoPotenziale decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_RateMutuiPrestitiDebitoPotenziale>';
    v_contenuto1 := '&lt;sp:LDREG_RateMutuiPrestitiEsercizio decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_RateMutuiPrestitiEsercizio>';
    v_contenuto2 := '&lt;sp:LDREG_RateMutuiPrestitiDebitoPotenziale decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_RateMutuiPrestitiDebitoPotenziale>';
  ELSIF r.tipo_riga = 'F)' THEN
    v_contenuto :=  '&lt;sp:LDREG_RateMutuiPrestitiEsercizio decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_RateMutuiPrestitiEsercizio>';
    v_contenuto2 := '&lt;sp:LDREG_RateMutuiPrestitiEsercizio decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_RateMutuiPrestitiEsercizio>';
  ELSIF r.tipo_riga = 'E)' THEN
    v_contenuto :=  '&lt;sp:LDREG_RateMutuiPrestitiEsercizioPrec decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_RateMutuiPrestitiEsercizioPrec>';
    v_contenuto1 := '&lt;sp:LDREG_RateMutuiPrestitiEsercizioPrec decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_RateMutuiPrestitiEsercizioPrec>';
    v_contenuto2 := '&lt;sp:LDREG_RateMutuiPrestitiEsercizioPrec decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_RateMutuiPrestitiEsercizioPrec>';
  ELSIF r.tipo_riga = 'B)' THEN
    v_contenuto :=  '&lt;sp:LDREG_TributiFinanziamentoSanita decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:LDREG_TributiFinanziamentoSanita>';
    v_contenuto1 := '&lt;sp:LDREG_TributiFinanziamentoSanita decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:LDREG_TributiFinanziamentoSanita>';
    v_contenuto2 := '&lt;sp:LDREG_TributiFinanziamentoSanita decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:LDREG_TributiFinanziamentoSanita>';
  END IF;
  c_riga := c_riga + 1;
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);
  c_riga := c_riga + 1;
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto1);
  c_riga := c_riga + 1;
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto2);

 END LOOP;  -- sdb_ldreg

 COMMIT;


 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- Prospetto Verifica Rispetto Dei Vincoli Di Finanza Pubblica  -->');


 FOR r in sdb_eqvfp_tit LOOP
  c_riga := c_riga + 1;
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,r.r_anno);
  c_riga := c_riga + 1;
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,r.r_anno1);
  c_riga := c_riga + 1;
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,r.r_anno2);
 END LOOP;

 FOR r in sdb_eqvfp_dett LOOP

  IF r.tipo_riga = 'A1' THEN
    v_contenuto :=  '&lt;sp:EQVFP_FPVEntrataSpeseCorrenti decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_FPVEntrataSpeseCorrenti>';
    v_contenuto1 := '&lt;sp:EQVFP_FPVEntrataSpeseCorrenti decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_FPVEntrataSpeseCorrenti>';
    v_contenuto2 := '&lt;sp:EQVFP_FPVEntrataSpeseCorrenti decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_FPVEntrataSpeseCorrenti>';
  ELSIF r.tipo_riga = 'A2' THEN
    v_contenuto :=  '&lt;sp:EQVFP_FPVEntrataCCapitaleNettoQuoteFinanzDebito decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_FPVEntrataCCapitaleNettoQuoteFinanzDebito>';
    v_contenuto1 := '&lt;sp:EQVFP_FPVEntrataCCapitaleNettoQuoteFinanzDebito decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_FPVEntrataCCapitaleNettoQuoteFinanzDebito>';
    v_contenuto2 := '&lt;sp:EQVFP_FPVEntrataCCapitaleNettoQuoteFinanzDebito decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_FPVEntrataCCapitaleNettoQuoteFinanzDebito>';
  ELSIF r.tipo_riga = 'A3' THEN --aggiornamento G.ZACCARO 25.03.2020
    v_contenuto :=  '&lt;sp:EQVFP_FPVEntrataPartiteFinaziarie decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_FPVEntrataPartiteFinaziarie>';
    v_contenuto1 := '&lt;sp:EQVFP_FPVEntrataPartiteFinaziarie decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_FPVEntrataPartiteFinaziarie>';
    v_contenuto2 := '&lt;sp:EQVFP_FPVEntrataPartiteFinaziarie decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_FPVEntrataPartiteFinaziarie>';
    ELSIF r.tipo_riga = 'A' THEN --aggiornamento Gerry 22-03-2019
    v_contenuto :=  '&lt;sp:EQVFP_FPVEntrata decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_FPVEntrata>';
    v_contenuto1 := '&lt;sp:EQVFP_FPVEntrata decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_FPVEntrata>';
    v_contenuto2 := '&lt;sp:EQVFP_FPVEntrata decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_FPVEntrata>';
    ELSIF r.tipo_riga = 'G' THEN --aggiornamento G.ZACCARO 25.03.2020
    v_contenuto :=  '&lt;sp:EQVFP_SpaziFinaziariAcquisiti decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpaziFinaziariAcquisiti>';
    v_contenuto1 := '&lt;sp:EQVFP_SpaziFinaziariAcquisiti decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpaziFinaziariAcquisiti>';
  ELSIF r.tipo_riga = 'H1' THEN
    v_contenuto2 := '&lt;sp:EQVFP_SpaziFinaziariAcquisiti decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpaziFinaziariAcquisiti>';
  -- ATTENZIONE ASSICURARSI CHE EQVFP_SpaziFinanziariLS2016Art1.728 e (G) e EQVFP_SpaziFinanziariLS2016Art1.732 (M)
  -- NON VADANO INVERITI RISPETTO A TIPO_RIGA (non avevo elementi per distinguere se non l'ordine di apparizione dei tag nell'excel nell'xsd)
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo1NettoFPV decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo1NettoFPV>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo1NettoFPV decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo1NettoFPV>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo1NettoFPV decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo1NettoFPV>';
  ELSIF r.tipo_riga = 'H2' THEN
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo1FPV decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo1FPV>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo1FPV decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo1FPV>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo1FPV decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo1FPV>';
  ELSIF r.tipo_riga = 'H3' THEN
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo1FCDDE decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo1FCDDE>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo1FCDDE decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo1FCDDE>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo1FCDDE decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo1FCDDE>';
  ELSIF r.tipo_riga = 'H4' THEN
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo1FondoContenzioso decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo1FondoContenzioso>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo1FondoContenzioso decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo1FondoContenzioso>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo1FondoContenzioso decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo1FondoContenzioso>';
  ELSIF r.tipo_riga = 'H5' THEN
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo1AltriAccantonamenti decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo1AltriAccantonamenti>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo1AltriAccantonamenti decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo1AltriAccantonamenti>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo1AltriAccantonamenti decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo1AltriAccantonamenti>';
  ELSIF r.tipo_riga = 'H' THEN --new aggiornamento Gerry 22-03-2019
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo1SpeseCorrentiPF decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo1SpeseCorrentiPF>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo1SpeseCorrentiPF decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo1SpeseCorrentiPF>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo1SpeseCorrentiPF decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo1SpeseCorrentiPF>';
  ELSIF r.tipo_riga = 'I1' THEN
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo2NettoFPV decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo2NettoFPV>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo2NettoFPV decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo2NettoFPV>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo2NettoFPV decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo2NettoFPV>';
  ELSIF r.tipo_riga = 'I2' THEN --new aggiornamento Gerry 22-03-2019
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo2FPVNettoQuoteFinanzDebito decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo2FPVNettoQuoteFinanzDebito>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo2FPVNettoQuoteFinanzDebito decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo2FPVNettoQuoteFinanzDebito>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo2FPVNettoQuoteFinanzDebito decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo2FPVNettoQuoteFinanzDebito>';
  ELSIF r.tipo_riga = 'I3' THEN
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo2FCDDE decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo2FCDDE>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo2FCDDE decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo2FCDDE>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo2FCDDE decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo2FCDDE>';
  ELSIF r.tipo_riga = 'I4' THEN
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo2AltriAccantonamenti decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo2AltriAccantonamenti>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo2AltriAccantonamenti decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo2AltriAccantonamenti>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo2AltriAccantonamenti decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo2AltriAccantonamenti>';
  ELSIF r.tipo_riga = 'I' THEN --new aggiornamento Gerry 22-03-2019
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo2CapitaleFP decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo2CapitaleFP>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo2CapitaleFP decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo2CapitaleFP>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo2CapitaleFP decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo2CapitaleFP>';
  ELSIF r.tipo_riga = 'L' THEN
  ELSIF r.tipo_riga = 'L1' THEN -- new aggiornamento Gerry 22-03-2019
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo3 decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo3>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo3 decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo3>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo3 decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo3>';
    v_contenuto := '&lt;sp:EQVFP_SpeTitolo3IncAttFinNettoFPV decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_SpeTitolo3IncAttFinNettoFPV>';
    v_contenuto1 := '&lt;sp:EQVFP_SpeTitolo3IncAttFinNettoFPV decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_SpeTitolo3IncAttFinNettoFPV>';
    v_contenuto2 := '&lt;sp:EQVFP_SpeTitolo3IncAttFinNettoFPV decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_SpeTitolo3IncAttFinNettoFPV>';
  ELSIF r.tipo_riga = 'N' THEN
    v_contenuto := '&lt;sp:EQVFP_EquilibrioFinale decimals="2" contextRef="d_'||p_anno||'" unitRef="eur">'||r.stabil||'&lt;/sp:EQVFP_EquilibrioFinale>';
    v_contenuto1 := '&lt;sp:EQVFP_EquilibrioFinale decimals="2" contextRef="d_'||(p_anno+1)||'" unitRef="eur">'||r.stabil1||'&lt;/sp:EQVFP_EquilibrioFinale>';
    v_contenuto2 := '&lt;sp:EQVFP_EquilibrioFinale decimals="2" contextRef="d_'||(p_anno+2)||'" unitRef="eur">'||r.stabil2||'&lt;/sp:EQVFP_EquilibrioFinale>';
  END IF;

  c_riga := c_riga + 1;
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto);
  c_riga := c_riga + 1;
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto1);
  c_riga := c_riga + 1;
  INSERT INTO fin_t_bdap(utente,data_creazione,anno,tipo_trasmissione,eu,riga,contenuto) 
  VALUES (p_utente,SYSDATE,p_anno,'PREVSDB','E',c_riga,v_contenuto2);

 END LOOP;  --sdb_eqvfp_dett

COMMIT;

-- fine SDB uscite


 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'  &lt;!-- FATTI DA RIPORTARE - FINE -->');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVSDB','T',c_riga,'&lt;/xbrli:xbrl>');

commit;


-- ************ INDICATORI BILANCIO PREV *****************************

-- testata file
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',010,'&lt;?xml version="1.0" encoding="UTF-8"?>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',020,'&lt;xbrli:xbrl xmlns:ipe="http://www.rgs.mef.gov.it/xbrl/bdap/ind/prev/enti/2016-12-07" xmlns:ip="http://www.rgs.mef.gov.it/xbrl/bdap/ind/prev/2016-12-07" xmlns:link="http://www.xbrl.org/2003/linkbase" xmlns:num="http://www.xbrl.org/dtr/type/numeric" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:iso4217="http://www.xbrl.org/2003/iso4217" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xbrli="http://www.xbrl.org/2003/instance">');

insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',030,'  ');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',040,'  &lt;!--RIFERIMENTO ALLA TASSONOMIA (entry point) -->');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',050,'  &lt;link:schemaRef xlink:type="simple" xlink:href="bdap-ind-prev-regioni_2016-12-07.xsd"/>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',060,'  ');

-- CONTESTI 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',090,'  &lt;!-- CONTESTI -->');

    -- anno_0 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',190,'  &lt;xbrli:context id="d_'||(p_anno)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',200,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',210,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',220,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',230,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',240,'      &lt;xbrli:startDate>'||(p_anno)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',250,'      &lt;xbrli:endDate>'||(p_anno)||'-12-31&lt;/xbrli:endDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',260,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',270,'  &lt;/xbrli:context>');

-- anno_1 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',280,'  &lt;xbrli:context id="d_'||(p_anno +1)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',290,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',300,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',310,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',320,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',330,'      &lt;xbrli:startDate>'||(p_anno+1)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',340,'      &lt;xbrli:endDate>'||(p_anno+1)||'-12-31&lt;/xbrli:endDate>');
-- anno_2 
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',350,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',360,'  &lt;/xbrli:context>');

insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',370,'  &lt;xbrli:context id="d_'||(p_anno +2)||'">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',380,'    &lt;xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',390,'      &lt;xbrli:identifier scheme="http://www.rgs.mef.gov.it/xbrl/idente/codicebdap">'||p_id_ente||'&lt;/xbrli:identifier>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',400,'    &lt;/xbrli:entity>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',410,'    &lt;xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',420,'      &lt;xbrli:startDate>'||(p_anno+2)||'-01-01&lt;/xbrli:startDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',430,'      &lt;xbrli:endDate>'||(p_anno+2)||'-12-31&lt;/xbrli:endDate>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',440,'    &lt;/xbrli:period>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',450,'  &lt;/xbrli:context>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',460,'  ');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',470,'  &lt;!-- UNITA'' DI MISURA -->');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',480,'  &lt;xbrli:unit id="eur">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',490,'    &lt;xbrli:measure>iso4217:EUR&lt;/xbrli:measure>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',500,'  &lt;/xbrli:unit>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',510,'  &lt;xbrli:unit id="pure">');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',520,'    &lt;xbrli:measure>xbrli:pure&lt;/xbrli:measure>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',530,'  &lt;/xbrli:unit>');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',540,'  ');
insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',550,'  &lt;!-- FATTI DA RIPORTARE - INIZIO -->');

c_riga := 600;

-- *********************
-- indicatori Sintetici
-- *********************

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',c_riga,'  &lt;!-- Indicatori sintetici -->');

-- indicatori p_anno

     for is1 in ind_sintetici1 loop
        c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','S',c_riga,is1.is_tot_miss1);

     if is1.is_miss13_1 is not null
     then
        c_riga := c_riga+1;
         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','S',c_riga,is1.is_miss13_1);
     end if;

     if is1.is_no_miss13_1 is not null
     then
        c_riga := c_riga+1;
         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','S',c_riga,is1.is_no_miss13_1);
     end if;

     commit;
     end loop;

-- indicatori p_anno + 1

     for is2 in ind_sintetici2 loop

        c_riga := c_riga+1;
         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','S',c_riga,is2.is_tot_miss2);

     if is2.is_miss13_2 is not null
     then
        c_riga := c_riga+1;
         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','S',c_riga,is2.is_miss13_2);
     end if;

     if is2.is_no_miss13_2 is not null
     then
        c_riga := c_riga+1;
         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','S',c_riga,is2.is_no_miss13_2);
     end if;

    commit;
     end loop;

-- indicatori p_anno + 2

     for is3 in ind_sintetici3 loop

        c_riga := c_riga+1;
         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','S',c_riga,is3.is_tot_miss3);

     if is3.is_miss13_3 is not null
     then
        c_riga := c_riga+1;
         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','S',c_riga,is3.is_miss13_3);
     end if;

     if is3.is_no_miss13_3 is not null
     then
        c_riga := c_riga+1;
         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','S',c_riga,is3.is_no_miss13_3);
     end if;

     commit;
     end loop;

 -- *********************
 -- indicatori Entrate
 -- *********************

 c_riga := c_riga+1;

 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',c_riga,'  &lt;!-- Indicatori analitici Entrate -->');
     for ie in ind_entrata loop

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,ie.CompEnt);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,ie.CompeEntMediaAcc);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)--inserito 31/07/2018 Gerry
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,ie.Risc);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,ie.RiscMedia);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,ie.CompEnt2);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,ie.CompEnt3);

         commit;
     end loop;


     -- Totale Analitici Entrate
    select 
     '  &lt;ip:IA-ENT_TotaleEntrate_CompEnt  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(PREVCOMPE_SU_TOT1,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-ENT_TotaleEntrate_CompEnt>' 
    ,'  &lt;ip:IA-ENT_TotaleEntrate_CompEntMediaAcc  decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(MACC_SU_MTOT,0)/100,'9999999990.0000'))  ||'&lt;/ip:IA-ENT_TotaleEntrate_CompEntMediaAcc>'
    ,'  &lt;ip:IA-ENT_TotaleEntrate_Risc         decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(PREVCASSA_SU_TOT1,0)/100,'9999999990.0000'))  ||'&lt;/ip:IA-ENT_TotaleEntrate_Risc>'
    ,'  &lt;ip:IA-ENT_TotaleEntrate_RiscMedia     decimals="4" contextRef="d_'||(anno + 0)||'" unitRef="pure">'||ltrim(to_char(nvl(MRISC_SU_MACC,0)/100,'9999999990.0000'))    ||'&lt;/ip:IA-ENT_TotaleEntrate_RiscMedia>'
    ,'  &lt;ip:IA-ENT_TotaleEntrate_CompEnt  decimals="4" contextRef="d_'||(anno + 1)||'" unitRef="pure">'||ltrim(to_char(nvl(PREVCOMPE_SU_TOT2,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-ENT_TotaleEntrate_CompEnt>'
    ,'  &lt;ip:IA-ENT_TotaleEntrate_CompEnt  decimals="4" contextRef="d_'||(anno + 2)||'" unitRef="pure">'||ltrim(to_char(nvl(PREVCOMPE_SU_TOT2,0)/100,'9999999990.0000'))     ||'&lt;/ip:IA-ENT_TotaleEntrate_CompEnt>'
    into
      tot_CompEnt         
    ,tot_CompeEntMediaAcc
    ,tot_Risc             
    ,tot_RiscMedia          
    ,tot_CompEnt2         
    ,tot_CompEnt3 
    from fin_t_indicatori_bilancio 
    where anno = p_anno
    and utente = p_utente
    and nvl(tipo_bilancio,'X') = 'P'
    and nvl(tipo_indicatore,'X') = 'E'
    and upper(desc_cod1) = 'TOTALE ENTRATE'
    order by ord;

    c_riga := c_riga+1;

     insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
     values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,tot_CompEnt);

     c_riga := c_riga+1;

     insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
     values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,tot_CompeEntMediaAcc);

     c_riga := c_riga+1;

     insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
     values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,tot_Risc);

     c_riga := c_riga+1;

     insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
     values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,tot_RiscMedia);

     c_riga := c_riga+1;

     insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
     values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,tot_CompEnt2);

     c_riga := c_riga+1;

     insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
     values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,tot_CompEnt3);

     commit;


 -- *********************
 -- indicatori Uscite
 -- *********************

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',c_riga,'  &lt;!-- Indicatori analitici Uscite -->');

     for iu in ind_spese loop

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,iu.CompSpeMissProg);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)

         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,iu.CompSpeMissProg2);

         c_riga := c_riga+1;
         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,iu.CompSpeMissProg3);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,iu.CompSpeMissProgFPV);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,iu.CompSpeMissProgFPV2);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,iu.CompSpeMissProgFPV3);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,iu.CapPag);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,iu.CompSpeMissProgMedia);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,iu.CompSpeMissProgFPVMedia);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,iu.CapPagMedia);

         commit;
     end loop;

for im in ind_spese_missioni loop

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,im.CompSpeMissProg);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,im.CompSpeMissProg2);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,im.CompSpeMissProg3);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,im.CompSpeMissProgFPV);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,im.CompSpeMissProgFPV2);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','U',c_riga,im.CompSpeMissProgFPV3);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,im.CapPag);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,im.CompSpeMissProgMedia);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,im.CompSpeMissProgFPVMedia);

         c_riga := c_riga+1;

         insert into FIN_T_BDAP (UTENTE,DATA_CREAZIONE,ANNO,TIPO_TRASMISSIONE,EU,RIGA,CONTENUTO)
         values (p_utente,sysdate,p_anno,'PREVIND','E',c_riga,im.CapPagMedia);

         commit;
     end loop;

 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',c_riga,'  &lt;!-- FATTI DA RIPORTARE - FINE -->');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',c_riga,' ');
 c_riga := c_riga+1;
 insert into fin_t_bdap values (p_utente,sysdate,p_anno,'PREVIND','T',c_riga,'&lt;/xbrli:xbrl>');

     commit;



end;</pre>	</td></tr>
</table></div>